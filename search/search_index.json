{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"<p>Welcome to the wiki page for the sing-box project.</p> <p>The universal proxy platform.</p>"},{"location":"#license","title":"License","text":"<pre><code>Copyright (C) 2022 by nekohasekai &lt;contact-sagernet@sekai.icu&gt;\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program. If not, see &lt;http://www.gnu.org/licenses/&gt;.\n\nIn addition, no derivative work may use the name or imply association\nwith this application without prior consent.\n</code></pre>"},{"location":"changelog/","title":"Change Log","text":""},{"location":"changelog/#130","title":"1.3.0","text":"<ul> <li>Fix bugs and update dependencies</li> </ul> <p>Important changes since 1.2:</p> <ul> <li>Add FakeIP support 1</li> <li>Improve multiplex 2</li> <li>Add DNS reverse mapping support</li> <li>Add <code>rewrite_ttl</code> DNS rule action</li> <li>Add <code>store_fakeip</code> Clash API option</li> <li>Add multi-peer support for WireGuard outbound</li> <li>Add loopback detect</li> <li>Add Clash.Meta API compatibility for Clash API</li> <li>Download Yacd-meta by default if the specified Clash <code>external_ui</code> directory is empty</li> <li>Add path and headers option for HTTP outbound</li> <li>Perform URLTest recheck after network changes</li> <li>Fix <code>system</code> tun stack for ios</li> <li>Fix network monitor for android/ios</li> <li>Update VLESS and XUDP protocol</li> <li>Make splice work with traffic statistics systems like Clash API</li> <li>Significantly reduces memory usage of idle connections</li> <li>Improve DNS caching</li> <li>Add <code>independent_cache</code> option for DNS</li> <li>Reimplemented shadowsocks client</li> <li>Add multiplex support for VLESS outbound</li> <li>Automatically add Windows firewall rules in order for the system tun stack to work</li> <li>Fix TLS 1.2 support for shadow-tls client</li> <li>Add <code>cache_id</code> option for Clash cache file</li> <li>Fix <code>local</code> DNS transport for Android</li> </ul> <p>1:</p> <p>See FAQ for more information.</p> <p>2:</p> <p>Added new <code>h2mux</code> multiplex protocol and <code>padding</code> multiplex option, see Multiplex.</p>"},{"location":"changelog/#13-rc2","title":"1.3-rc2","text":"<ul> <li>Fix <code>local</code> DNS transport for Android</li> <li>Fix bugs and update dependencies</li> </ul>"},{"location":"changelog/#13-rc1","title":"1.3-rc1","text":"<ul> <li>Fix bugs and update dependencies</li> </ul>"},{"location":"changelog/#13-beta14","title":"1.3-beta14","text":"<ul> <li>Fixes and improvements</li> </ul>"},{"location":"changelog/#13-beta13","title":"1.3-beta13","text":"<ul> <li>Fix resolving fakeip domains  1</li> <li>Deprecate L3 routing</li> <li>Fix bugs and update dependencies</li> </ul> <p>1:</p> <p>If the destination address of the connection is obtained from fakeip, dns rules with server type fakeip will be skipped.</p>"},{"location":"changelog/#13-beta12","title":"1.3-beta12","text":"<ul> <li>Automatically add Windows firewall rules in order for the system tun stack to work</li> <li>Fix TLS 1.2 support for shadow-tls client</li> <li>Add <code>cache_id</code> option for Clash cache file</li> <li>Fixes and improvements</li> </ul>"},{"location":"changelog/#13-beta11","title":"1.3-beta11","text":"<ul> <li>Fix bugs and update dependencies</li> </ul>"},{"location":"changelog/#13-beta10","title":"1.3-beta10","text":"<ul> <li>Improve direct copy 1</li> <li>Improve DNS caching</li> <li>Add <code>independent_cache</code> option for DNS</li> <li>Reimplemented shadowsocks client 2</li> <li>Add multiplex support for VLESS outbound</li> <li>Set TCP keepalive for WireGuard gVisor TCP connections</li> <li>Fixes and improvements</li> </ul> <p>1:</p> <ul> <li>Make splice work with traffic statistics systems like Clash API</li> <li>Significantly reduces memory usage of idle connections</li> </ul> <p>2:</p> <p>Improved performance and reduced memory usage.</p>"},{"location":"changelog/#13-beta9","title":"1.3-beta9","text":"<ul> <li>Improve multiplex 1</li> <li>Fixes and improvements</li> </ul> <p>1:</p> <p>Added new <code>h2mux</code> multiplex protocol and <code>padding</code> multiplex option, see Multiplex.</p>"},{"location":"changelog/#126","title":"1.2.6","text":"<ul> <li>Fix bugs and update dependencies</li> </ul>"},{"location":"changelog/#13-beta8","title":"1.3-beta8","text":"<ul> <li>Fix <code>system</code> tun stack for ios</li> <li>Fix network monitor for android/ios</li> <li>Update VLESS and XUDP protocol 1</li> <li>Fixes and improvements</li> </ul> <p>*1:</p> <p>This is an incompatible update for XUDP in VLESS if vision flow is enabled.</p>"},{"location":"changelog/#13-beta7","title":"1.3-beta7","text":"<ul> <li>Add <code>path</code> and <code>headers</code> options for HTTP outbound</li> <li>Add multi-user support for Shadowsocks legacy AEAD inbound</li> <li>Fixes and improvements</li> </ul>"},{"location":"changelog/#124","title":"1.2.4","text":"<ul> <li>Fixes and improvements</li> </ul>"},{"location":"changelog/#13-beta6","title":"1.3-beta6","text":"<ul> <li>Fix WireGuard reconnect</li> <li>Perform URLTest recheck after network changes</li> <li>Fix bugs and update dependencies</li> </ul>"},{"location":"changelog/#13-beta5","title":"1.3-beta5","text":"<ul> <li>Add Clash.Meta API compatibility for Clash API</li> <li>Download Yacd-meta by default if the specified Clash <code>external_ui</code> directory is empty</li> <li>Add path and headers option for HTTP outbound</li> <li>Fixes and improvements</li> </ul>"},{"location":"changelog/#13-beta4","title":"1.3-beta4","text":"<ul> <li>Fix bugs</li> </ul>"},{"location":"changelog/#13-beta2","title":"1.3-beta2","text":"<ul> <li>Download clash-dashboard if the specified Clash <code>external_ui</code> directory is empty</li> <li>Fix bugs and update dependencies</li> </ul>"},{"location":"changelog/#13-beta1","title":"1.3-beta1","text":"<ul> <li>Add DNS reverse mapping support</li> <li>Add L3 routing support 1</li> <li>Add <code>rewrite_ttl</code> DNS rule action</li> <li>Add FakeIP support 2</li> <li>Add <code>store_fakeip</code> Clash API option</li> <li>Add multi-peer support for WireGuard outbound</li> <li>Add loopback detect</li> </ul> <p>1:</p> <p>It can currently be used to route connections directly to WireGuard or block connections at the IP layer.</p> <p>2:</p> <p>See FAQ for more information.</p>"},{"location":"changelog/#123","title":"1.2.3","text":"<ul> <li>Introducing our new Android client application</li> <li>Improve UDP domain destination NAT</li> <li>Update reality protocol</li> <li>Fix TTL calculation for DNS response</li> <li>Fix v2ray HTTP transport compatibility</li> <li>Fix bugs and update dependencies</li> </ul>"},{"location":"changelog/#122","title":"1.2.2","text":"<ul> <li>Accept <code>any</code> outbound in dns rule 1</li> <li>Fix bugs and update dependencies</li> </ul> <p>1:</p> <p>Now you can use the <code>any</code> outbound rule to match server address queries instead of filling in all server domains to <code>domain</code> rule.</p>"},{"location":"changelog/#121","title":"1.2.1","text":"<ul> <li>Fix missing default host in v2ray http transport`s request</li> <li>Flush DNS cache for macOS when tun start/close</li> <li>Fix tun's DNS hijacking compatibility with systemd-resolved</li> </ul>"},{"location":"changelog/#120","title":"1.2.0","text":"<ul> <li>Fix bugs and update dependencies</li> </ul> <p>Important changes since 1.1:</p> <ul> <li>Introducing our new iOS client application</li> <li>Introducing UDP over TCP protocol version 2</li> <li>Add platform options for tun inbound</li> <li>Add ShadowTLS protocol v3</li> <li>Add VLESS server and vision support</li> <li>Add reality TLS support</li> <li>Add NTP service</li> <li>Add DHCP DNS server support</li> <li>Add SSH host key validation support</li> <li>Add query_type DNS rule item</li> <li>Add fallback support for v2ray transport</li> <li>Add custom TLS server support for http based v2ray transports</li> <li>Add health check support for http-based v2ray transports</li> <li>Add multiple configuration support</li> </ul>"},{"location":"changelog/#12-rc1","title":"1.2-rc1","text":"<ul> <li>Fix bugs and update dependencies</li> </ul>"},{"location":"changelog/#12-beta10","title":"1.2-beta10","text":"<ul> <li>Add multiple configuration support 1</li> <li>Fix bugs and update dependencies</li> </ul> <p>1:</p> <p>Now you can pass the parameter <code>--config</code> or <code>-c</code> multiple times, or use the new parameter <code>--config-directory</code> or <code>-C</code> to load all configuration files in a directory.</p> <p>Loaded configuration files are sorted by name. If you want to control the merge order, add a numeric prefix to the file name.</p>"},{"location":"changelog/#117","title":"1.1.7","text":"<ul> <li>Improve the stability of the VMESS server</li> <li>Fix <code>auto_detect_interface</code> incorrectly identifying the default interface on Windows</li> <li>Fix bugs and update dependencies</li> </ul>"},{"location":"changelog/#12-beta9","title":"1.2-beta9","text":"<ul> <li>Introducing the UDP over TCP protocol version 2</li> <li>Add health check support for http-based v2ray transports</li> <li>Remove length limit on short_id for reality TLS config</li> <li>Fix bugs and update dependencies</li> </ul>"},{"location":"changelog/#12-beta8","title":"1.2-beta8","text":"<ul> <li>Update reality and uTLS libraries</li> <li>Fix <code>auto_detect_interface</code> incorrectly identifying the default interface on Windows</li> </ul>"},{"location":"changelog/#12-beta7","title":"1.2-beta7","text":"<ul> <li>Fix the compatibility issue between VLESS's vision sub-protocol and the Xray-core client</li> <li>Improve the stability of the VMESS server</li> </ul>"},{"location":"changelog/#12-beta6","title":"1.2-beta6","text":"<ul> <li>Introducing our new iOS client application</li> <li>Add platform options for tun inbound</li> <li>Add custom TLS server support for http based v2ray transports</li> <li>Add generate commands</li> <li>Enable XUDP by default in VLESS</li> <li>Update reality server</li> <li>Update vision protocol</li> <li>Fixed user flow in vless server</li> <li>Bug fixes</li> <li>Update dependencies</li> </ul>"},{"location":"changelog/#12-beta5","title":"1.2-beta5","text":"<ul> <li>Add VLESS server and vision support</li> <li>Add reality TLS support</li> <li>Fix match private address</li> </ul>"},{"location":"changelog/#116","title":"1.1.6","text":"<ul> <li>Improve vmess request</li> <li>Fix ipv6 redirect on Linux</li> <li>Fix match geoip private</li> <li>Fix parse hysteria UDP message</li> <li>Fix socks connect response</li> <li>Disable vmess header protection if transport enabled</li> <li>Update QUIC v2 version number and initial salt</li> </ul>"},{"location":"changelog/#12-beta4","title":"1.2-beta4","text":"<ul> <li>Add NTP service</li> <li>Add Add multiple server names and multi-user support for shadowtls</li> <li>Add strict mode support for shadowtls v3</li> <li>Add uTLS support for shadowtls v3</li> </ul>"},{"location":"changelog/#12-beta3","title":"1.2-beta3","text":"<ul> <li>Update QUIC v2 version number and initial salt</li> <li>Fix shadowtls v3 implementation</li> </ul>"},{"location":"changelog/#12-beta2","title":"1.2-beta2","text":"<ul> <li>Add ShadowTLS protocol v3</li> <li>Add fallback support for v2ray transport</li> <li>Fix parse hysteria UDP message</li> <li>Fix socks connect response</li> <li>Disable vmess header protection if transport enabled</li> </ul>"},{"location":"changelog/#12-beta1","title":"1.2-beta1","text":"<ul> <li>Add DHCP DNS server support</li> <li>Add SSH host key validation support</li> <li>Add query_type DNS rule item</li> <li>Add v2ray user stats api</li> <li>Add new clash DNS query api</li> <li>Improve vmess request</li> <li>Fix ipv6 redirect on Linux</li> <li>Fix match geoip private</li> </ul>"},{"location":"changelog/#115","title":"1.1.5","text":"<ul> <li>Add Go 1.20 support</li> <li>Fix inbound default DF value</li> <li>Fix auth_user route for naive inbound</li> <li>Fix gRPC lite header</li> <li>Ignore domain case in route rules</li> </ul>"},{"location":"changelog/#114","title":"1.1.4","text":"<ul> <li>Fix DNS log</li> <li>Fix write to h2 conn after closed</li> <li>Fix create UDP DNS transport from plain IPv6 address</li> </ul>"},{"location":"changelog/#112","title":"1.1.2","text":"<ul> <li>Fix http proxy auth</li> <li>Fix user from stream packet conn</li> <li>Fix DNS response TTL</li> <li>Fix override packet conn</li> <li>Skip override system proxy bypass list</li> <li>Improve DNS log</li> </ul>"},{"location":"changelog/#111","title":"1.1.1","text":"<ul> <li>Fix acme config</li> <li>Fix vmess packet conn</li> <li>Suppress quic-go set DF error</li> </ul>"},{"location":"changelog/#11","title":"1.1","text":"<ul> <li>Fix close clash cache</li> </ul> <p>Important changes since 1.0:</p> <ul> <li>Add support for use with android VPNService</li> <li>Add tun support for WireGuard outbound</li> <li>Add system tun stack</li> <li>Add comment filter for config</li> <li>Add option for allow optional proxy protocol header</li> <li>Add Clash mode and persistence support</li> <li>Add TLS ECH and uTLS support for outbound TLS options</li> <li>Add internal simple-obfs and v2ray-plugin</li> <li>Add ShadowsocksR outbound</li> <li>Add VLESS outbound and XUDP</li> <li>Skip wait for hysteria tcp handshake response</li> <li>Add v2ray mux support for all inbound</li> <li>Add XUDP support for VMess</li> <li>Improve websocket writer</li> <li>Refine tproxy write back</li> <li>Fix DNS leak caused by   Windows' ordinary multihomed DNS resolution behavior</li> <li>Add sniff_timeout listen option</li> <li>Add custom route support for tun</li> <li>Add option for custom wireguard reserved bytes</li> <li>Split bind_address into ipv4 and ipv6</li> <li>Add ShadowTLS v1 and v2 support</li> </ul>"},{"location":"changelog/#11-rc1","title":"1.1-rc1","text":"<ul> <li>Fix TLS config for h2 server</li> <li>Fix crash when input bad method in shadowsocks multi-user inbound</li> <li>Fix listen UDP</li> <li>Fix check invalid packet on macOS</li> </ul>"},{"location":"changelog/#11-beta18","title":"1.1-beta18","text":"<ul> <li>Enhance defense against active probe for shadowtls server 1</li> </ul> <p>1:</p> <p>The <code>fallback_after</code> option has been removed.</p>"},{"location":"changelog/#11-beta17","title":"1.1-beta17","text":"<ul> <li>Fix shadowtls server 1</li> </ul> <p>1:</p> <p>Added fallback_after option.</p>"},{"location":"changelog/#107","title":"1.0.7","text":"<ul> <li>Add support for new x/h2 deadline</li> <li>Fix copy pipe</li> <li>Fix decrypt xplus packet</li> <li>Fix macOS Ventura process name match</li> <li>Fix smux keepalive</li> <li>Fix vmess request buffer</li> <li>Fix h2c transport</li> <li>Fix tor geoip</li> <li>Fix udp connect for mux client</li> <li>Fix default dns transport strategy</li> </ul>"},{"location":"changelog/#11-beta16","title":"1.1-beta16","text":"<ul> <li>Improve shadowtls server</li> <li>Fix default dns transport strategy</li> <li>Update uTLS to v1.2.0</li> </ul>"},{"location":"changelog/#11-beta15","title":"1.1-beta15","text":"<ul> <li>Add support for new x/h2 deadline</li> <li>Fix udp connect for mux client</li> <li>Fix dns buffer</li> <li>Fix quic dns retry</li> <li>Fix create TLS config</li> <li>Fix websocket alpn</li> <li>Fix tor geoip</li> </ul>"},{"location":"changelog/#11-beta14","title":"1.1-beta14","text":"<ul> <li>Add multi-user support for hysteria inbound 1</li> <li>Add custom tls client support for std grpc</li> <li>Fix smux keep alive</li> <li>Fix vmess request buffer</li> <li>Fix default local DNS server behavior</li> <li>Fix h2c transport</li> </ul> <p>1:</p> <p>The <code>auth</code> and <code>auth_str</code> fields have been replaced by the <code>users</code> field.</p>"},{"location":"changelog/#11-beta13","title":"1.1-beta13","text":"<ul> <li>Add custom worker count option for WireGuard outbound</li> <li>Split bind_address into ipv4 and ipv6</li> <li>Move WFP manipulation to strict route</li> <li>Fix WireGuard outbound panic when close</li> <li>Fix macOS Ventura process name match</li> <li>Fix QUIC connection migration by @HyNetwork</li> <li>Fix handling QUIC client SNI by @HyNetwork</li> </ul>"},{"location":"changelog/#11-beta12","title":"1.1-beta12","text":"<ul> <li>Fix uTLS config</li> <li>Update quic-go to v0.30.0</li> <li>Update cloudflare-tls to go1.18.7</li> </ul>"},{"location":"changelog/#11-beta11","title":"1.1-beta11","text":"<ul> <li>Add option for custom wireguard reserved bytes</li> <li>Fix shadowtls v2</li> <li>Fix h3 dns transport</li> <li>Fix copy pipe</li> <li>Fix decrypt xplus packet</li> <li>Fix v2ray api</li> <li>Suppress no network error</li> <li>Improve local dns transport</li> </ul>"},{"location":"changelog/#11-beta10","title":"1.1-beta10","text":"<ul> <li>Add sniff_timeout listen option</li> <li>Add custom route support for tun 1</li> <li>Fix interface monitor</li> <li>Fix websocket headroom</li> <li>Fix uTLS handshake</li> <li>Fix ssh outbound</li> <li>Fix sniff fragmented quic client hello</li> <li>Fix DF for hysteria</li> <li>Fix naive overflow</li> <li>Check destination before udp connect</li> <li>Update uTLS to v1.1.5</li> <li>Update tfo-go to v2.0.2</li> <li>Update fsnotify to v1.6.0</li> <li>Update grpc to v1.50.1</li> </ul> <p>1:</p> <p>The <code>strict_route</code> on windows is removed.</p>"},{"location":"changelog/#106","title":"1.0.6","text":"<ul> <li>Fix ssh outbound</li> <li>Fix sniff fragmented quic client hello</li> <li>Fix naive overflow</li> <li>Check destination before udp connect</li> </ul>"},{"location":"changelog/#11-beta9","title":"1.1-beta9","text":"<ul> <li>Fix windows route 1</li> <li>Add v2ray statistics api</li> <li>Add ShadowTLS v2 support 2</li> <li>Fixes and improvements</li> </ul> <p>1:</p> <ul> <li>Fix DNS leak caused by   Windows' ordinary multihomed DNS resolution behavior</li> <li>Flush Windows DNS cache when start/close</li> </ul> <p>2:</p> <p>See ShadowTLS inbound and ShadowTLS outbound</p>"},{"location":"changelog/#11-beta8","title":"1.1-beta8","text":"<ul> <li>Fix leaks on close</li> <li>Improve websocket writer</li> <li>Refine tproxy write back</li> <li>Refine 4in6 processing</li> <li>Fix shadowsocks plugins</li> <li>Fix missing source address from transport connection</li> <li>Fix fqdn socks5 outbound connection</li> <li>Fix read source address from grpc-go</li> </ul>"},{"location":"changelog/#105","title":"1.0.5","text":"<ul> <li>Fix missing source address from transport connection</li> <li>Fix fqdn socks5 outbound connection</li> <li>Fix read source address from grpc-go</li> </ul>"},{"location":"changelog/#11-beta7","title":"1.1-beta7","text":"<ul> <li>Add v2ray mux and XUDP support for VMess inbound</li> <li>Add XUDP support for VMess outbound</li> <li>Disable DF on direct outbound by default</li> <li>Fix bugs in 1.1-beta6</li> </ul>"},{"location":"changelog/#11-beta6","title":"1.1-beta6","text":"<ul> <li>Add URLTest outbound</li> <li>Fix bugs in 1.1-beta5</li> </ul>"},{"location":"changelog/#11-beta5","title":"1.1-beta5","text":"<ul> <li>Print tags in version command</li> <li>Redirect clash hello to external ui</li> <li>Move shadowsocksr implementation to clash</li> <li>Make gVisor optional 1</li> <li>Refactor to miekg/dns</li> <li>Refactor bind control</li> <li>Fix build on go1.18</li> <li>Fix clash store-selected</li> <li>Fix close grpc conn</li> <li>Fix port rule match logic</li> <li>Fix clash api proxy type</li> </ul> <p>1:</p> <p>The build tag <code>no_gvisor</code> is replaced by <code>with_gvisor</code>.</p> <p>The default tun stack is changed to system.</p>"},{"location":"changelog/#104","title":"1.0.4","text":"<ul> <li>Fix close grpc conn</li> <li>Fix port rule match logic</li> <li>Fix clash api proxy type</li> </ul>"},{"location":"changelog/#11-beta4","title":"1.1-beta4","text":"<ul> <li>Add internal simple-obfs and v2ray-plugin Shadowsocks plugins</li> <li>Add ShadowsocksR outbound</li> <li>Add VLESS outbound and XUDP</li> <li>Skip wait for hysteria tcp handshake response</li> <li>Fix socks4 client</li> <li>Fix hysteria inbound</li> <li>Fix concurrent write</li> </ul>"},{"location":"changelog/#103","title":"1.0.3","text":"<ul> <li>Fix socks4 client</li> <li>Fix hysteria inbound</li> <li>Fix concurrent write</li> </ul>"},{"location":"changelog/#11-beta3","title":"1.1-beta3","text":"<ul> <li>Fix using custom TLS client in http2 client</li> <li>Fix bugs in 1.1-beta2</li> </ul>"},{"location":"changelog/#11-beta2","title":"1.1-beta2","text":"<ul> <li>Add Clash mode and persistence support 1</li> <li>Add TLS ECH and uTLS support for outbound TLS options 2</li> <li>Fix socks4 request</li> <li>Fix processing empty dns result</li> </ul> <p>1:</p> <p>Switching modes using the Clash API, and <code>store-selected</code> are now supported, see Experimental.</p> <p>2:</p> <p>ECH (Encrypted Client Hello) is a TLS extension that allows a client to encrypt the first part of its ClientHello message, see TLS#ECH.</p> <p>uTLS is a fork of \"crypto/tls\", which provides ClientHello fingerprinting resistance, see TLS#uTLS.</p>"},{"location":"changelog/#102","title":"1.0.2","text":"<ul> <li>Fix socks4 request</li> <li>Fix processing empty dns result</li> </ul>"},{"location":"changelog/#11-beta1","title":"1.1-beta1","text":"<ul> <li>Add support for use with android VPNService 1</li> <li>Add tun support for WireGuard outbound 2</li> <li>Add system tun stack 3</li> <li>Add comment filter for config 4</li> <li>Add option for allow optional proxy protocol header</li> <li>Add half close for smux</li> <li>Set UDP DF by default 5</li> <li>Set default tun mtu to 9000</li> <li>Update gVisor to 20220905.0</li> </ul> <p>1:</p> <p>In previous versions, Android VPN would not work with tun enabled.</p> <p>The usage of tun over VPN and VPN over tun is now supported, see Tun Inbound.</p> <p>2:</p> <p>In previous releases, WireGuard outbound support was backed by the lower performance gVisor virtual interface.</p> <p>It achieves the same performance as wireguard-go by providing automatic system interface support.</p> <p>3:</p> <p>It does not depend on gVisor and has better performance in some cases.</p> <p>It is less compatible and may not be available in some environments.</p> <p>4:</p> <p>Annotated json configuration files are now supported.</p> <p>5:</p> <p>UDP fragmentation is now blocked by default.</p> <p>Including shadowsocks-libev, shadowsocks-rust and quic-go all disable segmentation by default.</p> <p>See Dial Fields and Listen Fields.</p>"},{"location":"changelog/#101","title":"1.0.1","text":"<ul> <li>Fix match 4in6 address in ip_cidr</li> <li>Fix clash api log level format error</li> <li>Fix clash api unknown proxy type</li> </ul>"},{"location":"changelog/#10","title":"1.0","text":"<ul> <li>Fix wireguard reconnect</li> <li>Fix naive inbound</li> <li>Fix json format error message</li> <li>Fix processing vmess termination signal</li> <li>Fix hysteria stream error</li> <li>Fix listener close when proxyproto failed</li> </ul>"},{"location":"changelog/#10-rc1","title":"1.0-rc1","text":"<ul> <li>Fix write log timestamp</li> <li>Fix write zero</li> <li>Fix dial parallel in direct outbound</li> <li>Fix write trojan udp</li> <li>Fix DNS routing</li> <li>Add attribute support for geosite</li> <li>Update documentation for Dial Fields</li> </ul>"},{"location":"changelog/#10-beta3","title":"1.0-beta3","text":"<ul> <li>Add chained inbound support</li> <li>Add process_path rule item</li> <li>Add macOS redirect support</li> <li>Add ShadowTLS Inbound, Outbound   and Examples</li> <li>Fix search android package in non-owner users</li> <li>Fix socksaddr type condition</li> <li>Fix smux session status</li> <li>Refactor inbound and outbound documentation</li> <li>Minor fixes</li> </ul>"},{"location":"changelog/#10-beta2","title":"1.0-beta2","text":"<ul> <li>Add strict_route option for Tun inbound</li> <li>Add packetaddr support for VMess outbound</li> <li>Add better performing alternative gRPC implementation</li> <li>Add docker image</li> <li>Fix sniff override destination</li> </ul>"},{"location":"changelog/#10-beta1","title":"1.0-beta1","text":"<ul> <li>Initial release</li> </ul>"},{"location":"changelog/#20220826","title":"2022/08/26","text":"<ul> <li>Fix ipv6 route on linux</li> <li>Fix read DNS message</li> </ul>"},{"location":"changelog/#20220825","title":"2022/08/25","text":"<ul> <li>Let vmess use zero instead of auto if TLS enabled</li> <li>Add trojan fallback for ALPN</li> <li>Improve ip_cidr rule</li> <li>Fix format bind_address</li> <li>Fix http proxy with compressed response</li> <li>Fix route connections</li> </ul>"},{"location":"changelog/#20220824","title":"2022/08/24","text":"<ul> <li>Fix naive padding</li> <li>Fix unix search path</li> <li>Fix close non-duplex connections</li> <li>Add ACME EAB support</li> <li>Fix early close on windows and catch any</li> <li>Initial zh-CN document translation</li> </ul>"},{"location":"changelog/#20220823","title":"2022/08/23","text":"<ul> <li>Add V2Ray Transport support for VMess and Trojan</li> <li>Allow plain http request in Naive inbound (It can now be used with nginx)</li> <li>Add proxy protocol support</li> <li>Free memory after start</li> <li>Parse X-Forward-For in HTTP requests</li> <li>Handle SIGHUP signal</li> </ul>"},{"location":"changelog/#20220822","title":"2022/08/22","text":"<ul> <li>Add strategy setting for each DNS server</li> <li>Add bind address to outbound options</li> </ul>"},{"location":"changelog/#20220821","title":"2022/08/21","text":"<ul> <li>Add Tor outbound</li> <li>Add SSH outbound</li> </ul>"},{"location":"changelog/#20220820","title":"2022/08/20","text":"<ul> <li>Attempt to unwrap ip-in-fqdn socksaddr</li> <li>Fix read packages in android 12</li> <li>Fix route on some android devices</li> <li>Improve linux process searcher</li> <li>Fix write socks5 username password auth request</li> <li>Skip bind connection with private destination to interface</li> <li>Add Trojan connection fallback</li> </ul>"},{"location":"changelog/#20220819","title":"2022/08/19","text":"<ul> <li>Add Hysteria Inbound and Outbund</li> <li>Add ACME TLS certificate issuer</li> <li>Allow read config from stdin (-c stdin)</li> <li>Update gVisor to 20220815.0</li> </ul>"},{"location":"changelog/#20220818","title":"2022/08/18","text":"<ul> <li>Fix find process with lwip stack</li> <li>Fix crash on shadowsocks server</li> <li>Fix crash on darwin tun</li> <li>Fix write log to file</li> </ul>"},{"location":"changelog/#20220817","title":"2022/08/17","text":"<ul> <li>Improve async dns transports</li> </ul>"},{"location":"changelog/#20220816","title":"2022/08/16","text":"<ul> <li>Add ip_version (route/dns) rule item</li> <li>Add WireGuard outbound</li> </ul>"},{"location":"changelog/#20220815","title":"2022/08/15","text":"<ul> <li>Add uid, android user and package rules support in Tun routing.</li> </ul>"},{"location":"changelog/#20220813","title":"2022/08/13","text":"<ul> <li>Fix dns concurrent write</li> </ul>"},{"location":"changelog/#20220812","title":"2022/08/12","text":"<ul> <li>Performance improvements</li> <li>Add UoT option for SOCKS outbound</li> </ul>"},{"location":"changelog/#20220811","title":"2022/08/11","text":"<ul> <li>Add UoT option for Shadowsocks outbound, UoT support for all inbounds</li> </ul>"},{"location":"changelog/#20220810","title":"2022/08/10","text":"<ul> <li>Add full-featured Naive inbound</li> <li>Fix default dns server option #9 by iKirby</li> </ul>"},{"location":"changelog/#20220809","title":"2022/08/09","text":"<p>No changelog before.</p>"},{"location":"features/","title":"Features","text":""},{"location":"features/#server","title":"Server","text":"Feature v2ray-core clash Direct inbound \u2714 X SOCKS4a inbound \u2714 X Mixed (http/socks) inbound X \u2714 Shadowsocks AEAD 2022 single-user/multi-user/relay inbound X X VMess/Trojan inbound \u2714 X Naive/Hysteria inbound X X Resolve incoming domain names using custom policy X X Set system proxy on Windows/Linux/macOS/Android X X TLS certificate auto reload X X TLS ACME certificate issuer X X"},{"location":"features/#client","title":"Client","text":"Feature v2ray-core clash Set upstream client (proxy chain) TCP only, and has poor performance TCP only Bind to network interface Linux only \u2714 Custom dns strategy for resolving server address X X Fast fallback (RFC 6555) support for connect to server X X SOCKS4/4a outbound added by me X Shadowsocks AEAD 2022 outbound X X Shadowsocks UDP over TCP X X Multiplex (smux/yamux) mux.cool X Tor/WireGuard/Hysteria outbound X X Selector outbound and Clash API X \u2714"},{"location":"features/#sniffing","title":"Sniffing","text":"Protocol v2ray-core clash-premium HTTP Host \u2714 X QUIC ClientHello added by me added by me STUN X X Feature v2ray-core clash-premium For routing only added by me X No performance impact (like TCP splice) no general splice support X Set separately for each server \u2714 X"},{"location":"features/#routing","title":"Routing","text":"Feature v2ray-core clash-premium Auto detect interface X tun only Set default interface name X tun only Set default firewall mark X X"},{"location":"features/#routing-rule","title":"Routing Rule","text":"Rule v2ray-core clash Inbound \u2714 X IP Version X X User from inbound vmess and shadowsocks only X Sniffed protocol \u2714 X GeoSite \u2714 X Process name X \u2714 Android package name X X Linux user/user id X X Invert rule X X Logical rule X X"},{"location":"features/#dns","title":"DNS","text":"Feature v2ray-core clash DNS proxy A/AAAA only \u2714 DNS cache A/AAAA only X DNS routing X X DNS Over QUIC \u2714 X DNS Over HTTP3 X X Fake dns response with custom code X X"},{"location":"features/#tun","title":"Tun","text":"Feature clash-premium Full IPv6 support X Auto route on Linux/Windows/macOS/Android \u2714 Embed windows driver X Custom address/mtu X Limit uid (Linux) in routing X Limit android user in routing X Limit android package in routing X"},{"location":"features/#memory-usage","title":"Memory usage","text":"GeoSite code sing-box v2ray-core cn 17.8M 140.3M cn (Loyalsoldier) 74.3M 246.7M"},{"location":"features/#benchmark","title":"Benchmark","text":""},{"location":"features/#shadowsocks","title":"Shadowsocks","text":"/ none aes-128-gcm 2022-blake3-aes-128-gcm v2ray-core (5.0.7) 13.0 Gbps 5.02 Gbps / shadowsocks-rust (v1.15.0-alpha.5) 10.7 Gbps / 9.36 Gbps sing-box 29.0 Gbps / 11.8 Gbps"},{"location":"features/#vmess","title":"VMess","text":"/ TCP HTTP H2 TLS WebSocket TLS gRPC TLS v2ray-core (5.1.0) 7.86 GBps 2.86 Gbps 1.83 Gbps 2.36 Gbps 2.43 Gbps sing-box 7.96 Gbps 8.09 Gbps 6.11 Gbps 8.02 Gbps 6.35 Gbps"},{"location":"features/#license","title":"License","text":"/ License sing-box GPLv3 or later (Full open-source) v2ray-core MIT (Full open-source) clash GPLv3"},{"location":"support/","title":"Support","text":""},{"location":"support/#github","title":"Github","text":"<p>Issue: Issues \u00b7 SagerNet/sing-box</p>"},{"location":"support/#telegram","title":"Telegram","text":"<p>Notification channel: @yapnc User group: @yapug</p>"},{"location":"configuration/","title":"Introduction","text":"<p>sing-box uses JSON for configuration files.</p>"},{"location":"configuration/#structure","title":"Structure","text":"<pre><code>{\n\"log\": {},\n\"dns\": {},\n\"ntp\": {},\n\"inbounds\": [],\n\"outbounds\": [],\n\"route\": {},\n\"experimental\": {}\n}\n</code></pre>"},{"location":"configuration/#fields","title":"Fields","text":"Key Format <code>log</code> Log <code>dns</code> DNS <code>ntp</code> NTP <code>inbounds</code> Inbound <code>outbounds</code> Outbound <code>route</code> Route <code>experimental</code> Experimental"},{"location":"configuration/#check","title":"Check","text":"<pre><code>$ sing-box check\n</code></pre>"},{"location":"configuration/#format","title":"Format","text":"<pre><code>$ sing-box format -w\n</code></pre>"},{"location":"configuration/dns/","title":"DNS","text":""},{"location":"configuration/dns/#structure","title":"Structure","text":"<pre><code>{\n\"dns\": {\n\"servers\": [],\n\"rules\": [],\n\"final\": \"\",\n\"strategy\": \"\",\n\"disable_cache\": false,\n\"disable_expire\": false,\n\"independent_cache\": false,\n\"reverse_mapping\": false,\n\"fakeip\": {}\n}\n}\n</code></pre>"},{"location":"configuration/dns/#fields","title":"Fields","text":"Key Format <code>server</code> List of DNS Server <code>rules</code> List of DNS Rule <code>fakeip</code> FakeIP"},{"location":"configuration/dns/#final","title":"final","text":"<p>Default dns server tag.</p> <p>The first server will be used if empty.</p>"},{"location":"configuration/dns/#strategy","title":"strategy","text":"<p>Default domain strategy for resolving the domain names.</p> <p>One of <code>prefer_ipv4</code> <code>prefer_ipv6</code> <code>ipv4_only</code> <code>ipv6_only</code>.</p> <p>Take no effect if <code>server.strategy</code> is set.</p>"},{"location":"configuration/dns/#disable_cache","title":"disable_cache","text":"<p>Disable dns cache.</p>"},{"location":"configuration/dns/#disable_expire","title":"disable_expire","text":"<p>Disable dns cache expire.</p>"},{"location":"configuration/dns/#independent_cache","title":"independent_cache","text":"<p>Make each DNS server's cache independent for special purposes. If enabled, will slightly degrade performance.</p>"},{"location":"configuration/dns/#reverse_mapping","title":"reverse_mapping","text":"<p>Stores a reverse mapping of IP addresses after responding to a DNS query in order to provide domain names when routing.</p> <p>Since this process relies on the act of resolving domain names by an application before making a request, it can be problematic in environments such as macOS, where DNS is proxied and cached by the system.</p>"},{"location":"configuration/dns/#fakeip","title":"fakeip","text":"<p>FakeIP settings.</p>"},{"location":"configuration/dns/fakeip/","title":"FakeIP","text":""},{"location":"configuration/dns/fakeip/#structure","title":"Structure","text":"<pre><code>{\n\"enabled\": true,\n\"inet4_range\": \"198.18.0.0/15\",\n\"inet6_range\": \"fc00::/18\"\n}\n</code></pre>"},{"location":"configuration/dns/fakeip/#fields","title":"Fields","text":""},{"location":"configuration/dns/fakeip/#enabled","title":"enabled","text":"<p>Enable FakeIP service.</p>"},{"location":"configuration/dns/fakeip/#inet4_range","title":"inet4_range","text":"<p>IPv4 address range for FakeIP.</p>"},{"location":"configuration/dns/fakeip/#inet6_address","title":"inet6_address","text":"<p>IPv6 address range for FakeIP.</p>"},{"location":"configuration/dns/rule/","title":"DNS Rule","text":""},{"location":"configuration/dns/rule/#structure","title":"Structure","text":"<pre><code>{\n\"dns\": {\n\"rules\": [\n{\n\"inbound\": [\n\"mixed-in\"\n],\n\"ip_version\": 6,\n\"query_type\": [\n\"A\",\n\"HTTPS\",\n32768\n],\n\"network\": \"tcp\",\n\"auth_user\": [\n\"usera\",\n\"userb\"\n],\n\"protocol\": [\n\"tls\",\n\"http\",\n\"quic\"\n],\n\"domain\": [\n\"test.com\"\n],\n\"domain_suffix\": [\n\".cn\"\n],\n\"domain_keyword\": [\n\"test\"\n],\n\"domain_regex\": [\n\"^stun\\\\..+\"\n],\n\"geosite\": [\n\"cn\"\n],\n\"source_geoip\": [\n\"private\"\n],\n\"source_ip_cidr\": [\n\"10.0.0.0/24\",\n\"192.168.0.1\"\n],\n\"source_port\": [\n12345\n],\n\"source_port_range\": [\n\"1000:2000\",\n\":3000\",\n\"4000:\"\n],\n\"port\": [\n80,\n443\n],\n\"port_range\": [\n\"1000:2000\",\n\":3000\",\n\"4000:\"\n],\n\"process_name\": [\n\"curl\"\n],\n\"process_path\": [\n\"/usr/bin/curl\"\n],\n\"package_name\": [\n\"com.termux\"\n],\n\"user\": [\n\"sekai\"\n],\n\"user_id\": [\n1000\n],\n\"clash_mode\": \"direct\",\n\"invert\": false,\n\"outbound\": [\n\"direct\"\n],\n\"server\": \"local\",\n\"disable_cache\": false,\n\"rewrite_ttl\": 100\n},\n{\n\"type\": \"logical\",\n\"mode\": \"and\",\n\"rules\": [],\n\"server\": \"local\",\n\"disable_cache\": false,\n\"rewrite_ttl\": 100\n}\n]\n}\n}\n</code></pre> <p>You can ignore the JSON Array [] tag when the content is only one item</p>"},{"location":"configuration/dns/rule/#default-fields","title":"Default Fields","text":"<p>The default rule uses the following matching logic: (<code>domain</code> || <code>domain_suffix</code> || <code>domain_keyword</code> || <code>domain_regex</code> || <code>geosite</code>) &amp;&amp; (<code>port</code> || <code>port_range</code>) &amp;&amp; (<code>source_geoip</code> || <code>source_ip_cidr</code>) &amp;&amp; (<code>source_port</code> || <code>source_port_range</code>) &amp;&amp; <code>other fields</code></p>"},{"location":"configuration/dns/rule/#inbound","title":"inbound","text":"<p>Tags of Inbound.</p>"},{"location":"configuration/dns/rule/#ip_version","title":"ip_version","text":"<p>4 (A DNS query) or 6 (AAAA DNS query).</p> <p>Not limited if empty.</p>"},{"location":"configuration/dns/rule/#query_type","title":"query_type","text":"<p>DNS query type. Values can be integers or type name strings.</p>"},{"location":"configuration/dns/rule/#network","title":"network","text":"<p><code>tcp</code> or <code>udp</code>.</p>"},{"location":"configuration/dns/rule/#auth_user","title":"auth_user","text":"<p>Username, see each inbound for details.</p>"},{"location":"configuration/dns/rule/#protocol","title":"protocol","text":"<p>Sniffed protocol, see Sniff for details.</p>"},{"location":"configuration/dns/rule/#domain","title":"domain","text":"<p>Match full domain.</p>"},{"location":"configuration/dns/rule/#domain_suffix","title":"domain_suffix","text":"<p>Match domain suffix.</p>"},{"location":"configuration/dns/rule/#domain_keyword","title":"domain_keyword","text":"<p>Match domain using keyword.</p>"},{"location":"configuration/dns/rule/#domain_regex","title":"domain_regex","text":"<p>Match domain using regular expression.</p>"},{"location":"configuration/dns/rule/#geosite","title":"geosite","text":"<p>Match geosite.</p>"},{"location":"configuration/dns/rule/#source_geoip","title":"source_geoip","text":"<p>Match source geoip.</p>"},{"location":"configuration/dns/rule/#source_ip_cidr","title":"source_ip_cidr","text":"<p>Match source ip cidr.</p>"},{"location":"configuration/dns/rule/#source_port","title":"source_port","text":"<p>Match source port.</p>"},{"location":"configuration/dns/rule/#source_port_range","title":"source_port_range","text":"<p>Match source port range.</p>"},{"location":"configuration/dns/rule/#port","title":"port","text":"<p>Match port.</p>"},{"location":"configuration/dns/rule/#port_range","title":"port_range","text":"<p>Match port range.</p>"},{"location":"configuration/dns/rule/#process_name","title":"process_name","text":"<p>Only supported on Linux, Windows, and macOS.</p> <p>Match process name.</p>"},{"location":"configuration/dns/rule/#process_path","title":"process_path","text":"<p>Only supported on Linux, Windows, and macOS.</p> <p>Match process path.</p>"},{"location":"configuration/dns/rule/#package_name","title":"package_name","text":"<p>Match android package name.</p>"},{"location":"configuration/dns/rule/#user","title":"user","text":"<p>Only supported on Linux.</p> <p>Match user name.</p>"},{"location":"configuration/dns/rule/#user_id","title":"user_id","text":"<p>Only supported on Linux.</p> <p>Match user id.</p>"},{"location":"configuration/dns/rule/#clash_mode","title":"clash_mode","text":"<p>Match Clash mode.</p>"},{"location":"configuration/dns/rule/#invert","title":"invert","text":"<p>Invert match result.</p>"},{"location":"configuration/dns/rule/#outbound","title":"outbound","text":"<p>Match outbound.</p> <p><code>any</code> can be used as a value to match any outbound.</p>"},{"location":"configuration/dns/rule/#server","title":"server","text":"<p>Required</p> <p>Tag of the target dns server.</p>"},{"location":"configuration/dns/rule/#disable_cache","title":"disable_cache","text":"<p>Disable cache and save cache in this query.</p>"},{"location":"configuration/dns/rule/#rewrite_ttl","title":"rewrite_ttl","text":"<p>Rewrite TTL in DNS responses.</p>"},{"location":"configuration/dns/rule/#logical-fields","title":"Logical Fields","text":""},{"location":"configuration/dns/rule/#type","title":"type","text":"<p><code>logical</code></p>"},{"location":"configuration/dns/rule/#mode","title":"mode","text":"<p><code>and</code> or <code>or</code></p>"},{"location":"configuration/dns/rule/#rules","title":"rules","text":"<p>Included default rules.</p>"},{"location":"configuration/dns/server/","title":"DNS Server","text":""},{"location":"configuration/dns/server/#structure","title":"Structure","text":"<pre><code>{\n\"dns\": {\n\"servers\": [\n{\n\"tag\": \"google\",\n\"address\": \"tls://dns.google\",\n\"address_resolver\": \"local\",\n\"address_strategy\": \"prefer_ipv4\",\n\"strategy\": \"ipv4_only\",\n\"detour\": \"direct\"\n}\n]\n}\n}\n</code></pre>"},{"location":"configuration/dns/server/#fields","title":"Fields","text":""},{"location":"configuration/dns/server/#tag","title":"tag","text":"<p>The tag of the dns server.</p>"},{"location":"configuration/dns/server/#address","title":"address","text":"<p>Required</p> <p>The address of the dns server.</p> Protocol Format <code>System</code> <code>local</code> <code>TCP</code> <code>tcp://1.0.0.1</code> <code>UDP</code> <code>8.8.8.8</code> <code>udp://8.8.4.4</code> <code>TLS</code> <code>tls://dns.google</code> <code>HTTPS</code> <code>https://1.1.1.1/dns-query</code> <code>QUIC</code> <code>quic://dns.adguard.com</code> <code>HTTP3</code> <code>h3://8.8.8.8/dns-query</code> <code>RCode</code> <code>rcode://refused</code> <code>DHCP</code> <code>dhcp://auto</code> or <code>dhcp://en0</code> FakeIP <code>fakeip</code> <p>To ensure that system DNS is in effect, rather than Go's built-in default resolver, enable CGO at compile time.</p> <p>QUIC and HTTP3 transport is not included by default, see Installation.</p> <p>the RCode transport is often used to block queries. Use with rules and the <code>disable_cache</code> rule option.</p> <p>DHCP transport is not included by default, see Installation.</p> RCode Description <code>success</code> <code>No error</code> <code>format_error</code> <code>Format error</code> <code>server_failure</code> <code>Server failure</code> <code>name_error</code> <code>Non-existent domain</code> <code>not_implemented</code> <code>Not implemented</code> <code>refused</code> <code>Query refused</code>"},{"location":"configuration/dns/server/#address_resolver","title":"address_resolver","text":"<p>Required if address contains domain</p> <p>Tag of a another server to resolve the domain name in the address.</p>"},{"location":"configuration/dns/server/#address_strategy","title":"address_strategy","text":"<p>The domain strategy for resolving the domain name in the address.</p> <p>One of <code>prefer_ipv4</code> <code>prefer_ipv6</code> <code>ipv4_only</code> <code>ipv6_only</code>.</p> <p><code>dns.strategy</code> will be used if empty.</p>"},{"location":"configuration/dns/server/#strategy","title":"strategy","text":"<p>Default domain strategy for resolving the domain names.</p> <p>One of <code>prefer_ipv4</code> <code>prefer_ipv6</code> <code>ipv4_only</code> <code>ipv6_only</code>.</p> <p>Take no effect if override by other settings.</p>"},{"location":"configuration/dns/server/#detour","title":"detour","text":"<p>Tag of an outbound for connecting to the dns server.</p> <p>Default outbound will be used if empty.</p>"},{"location":"configuration/experimental/","title":"Experimental","text":""},{"location":"configuration/experimental/#structure","title":"Structure","text":"<pre><code>{\n\"experimental\": {\n\"clash_api\": {\n\"external_controller\": \"127.0.0.1:9090\",\n\"external_ui\": \"\",\n\"external_ui_download_url\": \"\",\n\"external_ui_download_detour\": \"\",\n\"secret\": \"\",\n\"default_mode\": \"\",\n\"store_selected\": false,\n\"cache_file\": \"\",\n\"cache_id\": \"\"\n},\n\"v2ray_api\": {\n\"listen\": \"127.0.0.1:8080\",\n\"stats\": {\n\"enabled\": true,\n\"inbounds\": [\n\"socks-in\"\n],\n\"outbounds\": [\n\"proxy\",\n\"direct\"\n],\n\"users\": [\n\"sekai\"\n]\n}\n}\n}\n}\n</code></pre> <p>Traffic statistics and connection management can degrade performance.</p>"},{"location":"configuration/experimental/#clash-api-fields","title":"Clash API Fields","text":"<p>Clash API is not included by default, see Installation.</p>"},{"location":"configuration/experimental/#external_controller","title":"external_controller","text":"<p>RESTful web API listening address. Clash API will be disabled if empty.</p>"},{"location":"configuration/experimental/#external_ui","title":"external_ui","text":"<p>A relative path to the configuration directory or an absolute path to a directory in which you put some static web resource. sing-box will then serve it at <code>http://{{external-controller}}/ui</code>.</p>"},{"location":"configuration/experimental/#external_ui_download_url","title":"external_ui_download_url","text":"<p>ZIP download URL for the external UI, will be used if the specified <code>external_ui</code> directory is empty.</p> <p><code>https://github.com/MetaCubeX/Yacd-meta/archive/gh-pages.zip</code> will be used if empty.</p>"},{"location":"configuration/experimental/#external_ui_download_detour","title":"external_ui_download_detour","text":"<p>The tag of the outbound to download the external UI.</p> <p>Default outbound will be used if empty.</p>"},{"location":"configuration/experimental/#secret","title":"secret","text":"<p>Secret for the RESTful API (optional) Authenticate by spedifying HTTP header <code>Authorization: Bearer ${secret}</code> ALWAYS set a secret if RESTful API is listening on 0.0.0.0</p>"},{"location":"configuration/experimental/#default_mode","title":"default_mode","text":"<p>Default mode in clash, <code>rule</code> will be used if empty.</p> <p>This setting has no direct effect, but can be used in routing and DNS rules via the <code>clash_mode</code> rule item.</p>"},{"location":"configuration/experimental/#store_selected","title":"store_selected","text":"<p>The tag must be set for target outbounds.</p> <p>Store selected outbound for the <code>Selector</code> outbound in cache file.</p>"},{"location":"configuration/experimental/#cache_file","title":"cache_file","text":"<p>Cache file path, <code>cache.db</code> will be used if empty.</p>"},{"location":"configuration/experimental/#cache_id","title":"cache_id","text":"<p>Cache ID.</p> <p>If not empty, <code>store_selected</code> will use a separate store keyed by it.</p>"},{"location":"configuration/experimental/#v2ray-api-fields","title":"V2Ray API Fields","text":"<p>V2Ray API is not included by default, see Installation.</p>"},{"location":"configuration/experimental/#listen","title":"listen","text":"<p>gRPC API listening address. V2Ray API will be disabled if empty.</p>"},{"location":"configuration/experimental/#stats","title":"stats","text":"<p>Traffic statistics service settings.</p>"},{"location":"configuration/experimental/#statsenabled","title":"stats.enabled","text":"<p>Enable statistics service.</p>"},{"location":"configuration/experimental/#statsinbounds","title":"stats.inbounds","text":"<p>Inbound list to count traffic.</p>"},{"location":"configuration/experimental/#statsoutbounds","title":"stats.outbounds","text":"<p>Outbound list to count traffic.</p>"},{"location":"configuration/experimental/#statsusers","title":"stats.users","text":"<p>User list to count traffic.</p>"},{"location":"configuration/inbound/","title":"Inbound","text":""},{"location":"configuration/inbound/#structure","title":"Structure","text":"<pre><code>{\n\"inbounds\": [\n{\n\"type\": \"\",\n\"tag\": \"\"\n}\n]\n}\n</code></pre>"},{"location":"configuration/inbound/#fields","title":"Fields","text":"Type Format Injectable <code>direct</code> Direct X <code>mixed</code> Mixed TCP <code>socks</code> SOCKS TCP <code>http</code> HTTP TCP <code>shadowsocks</code> Shadowsocks TCP <code>vmess</code> VMess TCP <code>trojan</code> Trojan TCP <code>naive</code> Naive X <code>hysteria</code> Hysteria X <code>shadowtls</code> ShadowTLS TCP <code>vless</code> VLESS TCP <code>tun</code> Tun X <code>redirect</code> Redirect X <code>tproxy</code> TProxy X"},{"location":"configuration/inbound/#tag","title":"tag","text":"<p>The tag of the inbound.</p>"},{"location":"configuration/inbound/direct/","title":"Direct","text":"<p><code>direct</code> inbound is a tunnel server.</p>"},{"location":"configuration/inbound/direct/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"direct\",\n\"tag\": \"direct-in\",\n... // Listen Fields\n\"network\": \"udp\",\n\"override_address\": \"1.0.0.1\",\n\"override_port\": 53\n}\n</code></pre>"},{"location":"configuration/inbound/direct/#listen-fields","title":"Listen Fields","text":"<p>See Listen Fields for details.</p>"},{"location":"configuration/inbound/direct/#fields","title":"Fields","text":""},{"location":"configuration/inbound/direct/#network","title":"network","text":"<p>Listen network, one of <code>tcp</code> <code>udp</code>.</p> <p>Both if empty.</p>"},{"location":"configuration/inbound/direct/#override_address","title":"override_address","text":"<p>Override the connection destination address.</p>"},{"location":"configuration/inbound/direct/#override_port","title":"override_port","text":"<p>Override the connection destination port.</p>"},{"location":"configuration/inbound/http/","title":"HTTP","text":""},{"location":"configuration/inbound/http/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"http\",\n\"tag\": \"http-in\",\n... // Listen Fields\n\"users\": [\n{\n\"username\": \"admin\",\n\"password\": \"admin\"\n}\n],\n\"tls\": {},\n\"set_system_proxy\": false\n}\n</code></pre>"},{"location":"configuration/inbound/http/#listen-fields","title":"Listen Fields","text":"<p>See Listen Fields for details.</p>"},{"location":"configuration/inbound/http/#fields","title":"Fields","text":""},{"location":"configuration/inbound/http/#tls","title":"tls","text":"<p>TLS configuration, see TLS.</p>"},{"location":"configuration/inbound/http/#users","title":"users","text":"<p>HTTP users.</p> <p>No authentication required if empty.</p>"},{"location":"configuration/inbound/http/#set_system_proxy","title":"set_system_proxy","text":"<p>Only supported on Linux, Android, Windows, and macOS.</p> <p>To work on Android and iOS without privileges, use tun.platform.http_proxy instead.</p> <p>Automatically set system proxy configuration when start and clean up when stop.</p>"},{"location":"configuration/inbound/hysteria/","title":"Hysteria","text":""},{"location":"configuration/inbound/hysteria/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"hysteria\",\n\"tag\": \"hysteria-in\",\n... // Listen Fields\n\"up\": \"100 Mbps\",\n\"up_mbps\": 100,\n\"down\": \"100 Mbps\",\n\"down_mbps\": 100,\n\"obfs\": \"fuck me till the daylight\",\n\"users\": [\n{\n\"name\": \"sekai\",\n\"auth\": \"\",\n\"auth_str\": \"password\"\n}\n],\n\"recv_window_conn\": 0,\n\"recv_window_client\": 0,\n\"max_conn_client\": 0,\n\"disable_mtu_discovery\": false,\n\"tls\": {}\n}\n</code></pre> <p>QUIC, which is required by hysteria is not included by default, see Installation.</p>"},{"location":"configuration/inbound/hysteria/#listen-fields","title":"Listen Fields","text":"<p>See Listen Fields for details.</p>"},{"location":"configuration/inbound/hysteria/#fields","title":"Fields","text":""},{"location":"configuration/inbound/hysteria/#up-down","title":"up, down","text":"<p>Required</p> <p>Format: <code>[Integer] [Unit]</code> e.g. <code>100 Mbps, 640 KBps, 2 Gbps</code></p> <p>Supported units (case sensitive, b = bits, B = bytes, 8b=1B):</p> <pre><code>bps (bits per second)\nBps (bytes per second)\nKbps (kilobits per second)\nKBps (kilobytes per second)\nMbps (megabits per second)\nMBps (megabytes per second)\nGbps (gigabits per second)\nGBps (gigabytes per second)\nTbps (terabits per second)\nTBps (terabytes per second)\n</code></pre>"},{"location":"configuration/inbound/hysteria/#up_mbps-down_mbps","title":"up_mbps, down_mbps","text":"<p>Required</p> <p><code>up, down</code> in Mbps.</p>"},{"location":"configuration/inbound/hysteria/#obfs","title":"obfs","text":"<p>Obfuscated password.</p>"},{"location":"configuration/inbound/hysteria/#users","title":"users","text":"<p>Hysteria users</p>"},{"location":"configuration/inbound/hysteria/#usersauth","title":"users.auth","text":"<p>Authentication password, in base64.</p>"},{"location":"configuration/inbound/hysteria/#usersauth_str","title":"users.auth_str","text":"<p>Authentication password.</p>"},{"location":"configuration/inbound/hysteria/#recv_window_conn","title":"recv_window_conn","text":"<p>The QUIC stream-level flow control window for receiving data.</p> <p><code>15728640 (15 MB/s)</code> will be used if empty.</p>"},{"location":"configuration/inbound/hysteria/#recv_window_client","title":"recv_window_client","text":"<p>The QUIC connection-level flow control window for receiving data.</p> <p><code>67108864 (64 MB/s)</code> will be used if empty.</p>"},{"location":"configuration/inbound/hysteria/#max_conn_client","title":"max_conn_client","text":"<p>The maximum number of QUIC concurrent bidirectional streams that a peer is allowed to open.</p> <p><code>1024</code> will be used if empty.</p>"},{"location":"configuration/inbound/hysteria/#disable_mtu_discovery","title":"disable_mtu_discovery","text":"<p>Disables Path MTU Discovery (RFC 8899). Packets will then be at most 1252 (IPv4) / 1232 (IPv6) bytes in size.</p> <p>Force enabled on for systems other than Linux and Windows (according to upstream).</p>"},{"location":"configuration/inbound/hysteria/#tls","title":"tls","text":"<p>Required</p> <p>TLS configuration, see TLS.</p>"},{"location":"configuration/inbound/mixed/","title":"Mixed","text":"<p><code>mixed</code> inbound is a socks4, socks4a, socks5 and http server.</p>"},{"location":"configuration/inbound/mixed/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"mixed\",\n\"tag\": \"mixed-in\",\n... // Listen Fields\n\"users\": [\n{\n\"username\": \"admin\",\n\"password\": \"admin\"\n}\n],\n\"set_system_proxy\": false\n}\n</code></pre>"},{"location":"configuration/inbound/mixed/#listen-fields","title":"Listen Fields","text":"<p>See Listen Fields for details.</p>"},{"location":"configuration/inbound/mixed/#fields","title":"Fields","text":""},{"location":"configuration/inbound/mixed/#users","title":"users","text":"<p>SOCKS and HTTP users.</p> <p>No authentication required if empty.</p>"},{"location":"configuration/inbound/mixed/#set_system_proxy","title":"set_system_proxy","text":"<p>Only supported on Linux, Android, Windows, and macOS.</p> <p>To work on Android and iOS without privileges, use tun.platform.http_proxy instead.</p> <p>Automatically set system proxy configuration when start and clean up when stop.</p>"},{"location":"configuration/inbound/naive/","title":"Naive","text":""},{"location":"configuration/inbound/naive/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"naive\",\n\"tag\": \"naive-in\",\n\"network\": \"udp\",\n... // Listen Fields\n\"users\": [\n{\n\"username\": \"sekai\",\n\"password\": \"password\"\n}\n],\n\"tls\": {}\n}\n</code></pre> <p>HTTP3 transport is not included by default, see Installation.</p>"},{"location":"configuration/inbound/naive/#listen-fields","title":"Listen Fields","text":"<p>See Listen Fields for details.</p>"},{"location":"configuration/inbound/naive/#fields","title":"Fields","text":""},{"location":"configuration/inbound/naive/#network","title":"network","text":"<p>Listen network, one of <code>tcp</code> <code>udp</code>.</p> <p>Both if empty.</p>"},{"location":"configuration/inbound/naive/#users","title":"users","text":"<p>Required</p> <p>Naive users.</p>"},{"location":"configuration/inbound/naive/#tls","title":"tls","text":"<p>TLS configuration, see TLS.</p>"},{"location":"configuration/inbound/redirect/","title":"Redirect","text":"<p>Only supported on Linux and macOS.</p>"},{"location":"configuration/inbound/redirect/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"redirect\",\n\"tag\": \"redirect-in\",\n... // Listen Fields\n}\n</code></pre>"},{"location":"configuration/inbound/redirect/#listen-fields","title":"Listen Fields","text":"<p>See Listen Fields for details.</p>"},{"location":"configuration/inbound/shadowsocks/","title":"Shadowsocks","text":""},{"location":"configuration/inbound/shadowsocks/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"shadowsocks\",\n\"tag\": \"ss-in\",\n... // Listen Fields\n\"method\": \"2022-blake3-aes-128-gcm\",\n\"password\": \"8JCsPssfgS8tiRwiMlhARg==\"\n}\n</code></pre>"},{"location":"configuration/inbound/shadowsocks/#multi-user-structure","title":"Multi-User Structure","text":"<pre><code>{\n\"method\": \"2022-blake3-aes-128-gcm\",\n\"password\": \"8JCsPssfgS8tiRwiMlhARg==\",\n\"users\": [\n{\n\"name\": \"sekai\",\n\"password\": \"PCD2Z4o12bKUoFa3cC97Hw==\"\n}\n]\n}\n</code></pre>"},{"location":"configuration/inbound/shadowsocks/#relay-structure","title":"Relay Structure","text":"<pre><code>{\n\"type\": \"shadowsocks\",\n\"method\": \"2022-blake3-aes-128-gcm\",\n\"password\": \"8JCsPssfgS8tiRwiMlhARg==\",\n\"destinations\": [\n{\n\"name\": \"test\",\n\"server\": \"example.com\",\n\"server_port\": 8080,\n\"password\": \"PCD2Z4o12bKUoFa3cC97Hw==\"\n}\n]\n}\n</code></pre>"},{"location":"configuration/inbound/shadowsocks/#listen-fields","title":"Listen Fields","text":"<p>See Listen Fields for details.</p>"},{"location":"configuration/inbound/shadowsocks/#fields","title":"Fields","text":""},{"location":"configuration/inbound/shadowsocks/#network","title":"network","text":"<p>Listen network, one of <code>tcp</code> <code>udp</code>.</p> <p>Both if empty.</p>"},{"location":"configuration/inbound/shadowsocks/#method","title":"method","text":"<p>Required</p> Method Key Length 2022-blake3-aes-128-gcm 16 2022-blake3-aes-256-gcm 32 2022-blake3-chacha20-poly1305 32 none / aes-128-gcm / aes-192-gcm / aes-256-gcm / chacha20-ietf-poly1305 / xchacha20-ietf-poly1305 /"},{"location":"configuration/inbound/shadowsocks/#password","title":"password","text":"<p>Required</p> Method Password Format none / 2022 methods <code>sing-box generate rand --base64 &lt;Key Length&gt;</code> other methods any string"},{"location":"configuration/inbound/shadowsocks/#listen-fields_1","title":"Listen Fields","text":""},{"location":"configuration/inbound/shadowsocks/#listen","title":"listen","text":"<p>Required</p> <p>Listen address.</p>"},{"location":"configuration/inbound/shadowsocks/#listen_port","title":"listen_port","text":"<p>Required</p> <p>Listen port.</p>"},{"location":"configuration/inbound/shadowsocks/#tcp_fast_open","title":"tcp_fast_open","text":"<p>Enable tcp fast open for listener.</p>"},{"location":"configuration/inbound/shadowsocks/#sniff","title":"sniff","text":"<p>Enable sniffing.</p> <p>See Protocol Sniff for details.</p>"},{"location":"configuration/inbound/shadowsocks/#sniff_override_destination","title":"sniff_override_destination","text":"<p>Override the connection destination address with the sniffed domain.</p> <p>If the domain name is invalid (like tor), this will not work.</p>"},{"location":"configuration/inbound/shadowsocks/#domain_strategy","title":"domain_strategy","text":"<p>One of <code>prefer_ipv4</code> <code>prefer_ipv6</code> <code>ipv4_only</code> <code>ipv6_only</code>.</p> <p>If set, the requested domain name will be resolved to IP before routing.</p> <p>If <code>sniff_override_destination</code> is in effect, its value will be taken as a fallback.</p>"},{"location":"configuration/inbound/shadowsocks/#udp_timeout","title":"udp_timeout","text":"<p>UDP NAT expiration time in seconds, default is 300 (5 minutes).</p>"},{"location":"configuration/inbound/shadowsocks/#proxy_protocol","title":"proxy_protocol","text":"<p>Parse Proxy Protocol in the connection header.</p>"},{"location":"configuration/inbound/shadowtls/","title":"ShadowTLS","text":""},{"location":"configuration/inbound/shadowtls/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"shadowtls\",\n\"tag\": \"st-in\",\n... // Listen Fields\n\"version\": 3,\n\"password\": \"fuck me till the daylight\",\n\"users\": [\n{\n\"name\": \"sekai\",\n\"password\": \"8JCsPssfgS8tiRwiMlhARg==\"\n}\n],\n\"handshake\": {\n\"server\": \"google.com\",\n\"server_port\": 443,\n... // Dial Fields\n},\n\"handshake_for_server_name\": {\n\"example.com\": {\n\"server\": \"example.com\",\n\"server_port\": 443,\n... // Dial Fields\n}\n},\n\"strict_mode\": false\n}\n</code></pre>"},{"location":"configuration/inbound/shadowtls/#listen-fields","title":"Listen Fields","text":"<p>See Listen Fields for details.</p>"},{"location":"configuration/inbound/shadowtls/#fields","title":"Fields","text":""},{"location":"configuration/inbound/shadowtls/#version","title":"version","text":"<p>ShadowTLS protocol version.</p> Value Protocol Version <code>1</code> (default) ShadowTLS v1 <code>2</code> ShadowTLS v2 <code>3</code> ShadowTLS v3"},{"location":"configuration/inbound/shadowtls/#password","title":"password","text":"<p>ShadowTLS password.</p> <p>Only available in the ShadowTLS protocol 2.</p>"},{"location":"configuration/inbound/shadowtls/#users","title":"users","text":"<p>ShadowTLS users.</p> <p>Only available in the ShadowTLS protocol 3.</p>"},{"location":"configuration/inbound/shadowtls/#handshake","title":"handshake","text":"<p>Required</p> <p>Handshake server address and Dial options.</p>"},{"location":"configuration/inbound/shadowtls/#handshake_for_server_name","title":"handshake_for_server_name","text":"<p>Handshake server address and Dial options for specific server name.</p> <p>Only available in the ShadowTLS protocol 2/3.</p>"},{"location":"configuration/inbound/shadowtls/#strict_mode","title":"strict_mode","text":"<p>ShadowTLS strict mode.</p> <p>Only available in the ShadowTLS protocol 3.</p>"},{"location":"configuration/inbound/socks/","title":"SOCKS","text":"<p><code>socks</code> inbound is a socks4, socks4a, socks5 server.</p>"},{"location":"configuration/inbound/socks/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"socks\",\n\"tag\": \"socks-in\",\n... // Listen Fields\n\"users\": [\n{\n\"username\": \"admin\",\n\"password\": \"admin\"\n}\n]\n}\n</code></pre>"},{"location":"configuration/inbound/socks/#listen-fields","title":"Listen Fields","text":"<p>See Listen Fields for details.</p>"},{"location":"configuration/inbound/socks/#fields","title":"Fields","text":""},{"location":"configuration/inbound/socks/#users","title":"users","text":"<p>SOCKS users.</p> <p>No authentication required if empty.</p>"},{"location":"configuration/inbound/tproxy/","title":"TProxy","text":"<p>Only supported on Linux.</p>"},{"location":"configuration/inbound/tproxy/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"tproxy\",\n\"tag\": \"tproxy-in\",\n... // Listen Fields\n\"network\": \"udp\"\n}\n</code></pre>"},{"location":"configuration/inbound/tproxy/#listen-fields","title":"Listen Fields","text":"<p>See Listen Fields for details.</p>"},{"location":"configuration/inbound/tproxy/#fields","title":"Fields","text":""},{"location":"configuration/inbound/tproxy/#network","title":"network","text":"<p>Listen network, one of <code>tcp</code> <code>udp</code>.</p> <p>Both if empty.</p>"},{"location":"configuration/inbound/trojan/","title":"Trojan","text":""},{"location":"configuration/inbound/trojan/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"trojan\",\n\"tag\": \"trojan-in\",\n... // Listen Fields\n\"users\": [\n{\n\"name\": \"sekai\",\n\"password\": \"8JCsPssfgS8tiRwiMlhARg==\"\n}\n],\n\"tls\": {},\n\"fallback\": {\n\"server\": \"127.0.0.1\",\n\"server_port\": 8080\n},\n\"fallback_for_alpn\": {\n\"http/1.1\": {\n\"server\": \"127.0.0.1\",\n\"server_port\": 8081\n}\n},\n\"transport\": {}\n}\n</code></pre>"},{"location":"configuration/inbound/trojan/#listen-fields","title":"Listen Fields","text":"<p>See Listen Fields for details.</p>"},{"location":"configuration/inbound/trojan/#fields","title":"Fields","text":""},{"location":"configuration/inbound/trojan/#users","title":"users","text":"<p>Required</p> <p>Trojan users.</p>"},{"location":"configuration/inbound/trojan/#tls","title":"tls","text":"<p>TLS configuration, see TLS.</p>"},{"location":"configuration/inbound/trojan/#fallback","title":"fallback","text":"<p>There is no evidence that GFW detects and blocks Trojan servers based on HTTP responses, and opening the standard http/s port on the server is a much bigger signature.</p> <p>Fallback server configuration. Disabled if <code>fallback</code> and <code>fallback_for_alpn</code> are empty.</p>"},{"location":"configuration/inbound/trojan/#fallback_for_alpn","title":"fallback_for_alpn","text":"<p>Fallback server configuration for specified ALPN.</p> <p>If not empty, TLS fallback requests with ALPN not in this table will be rejected.</p>"},{"location":"configuration/inbound/trojan/#transport","title":"transport","text":"<p>V2Ray Transport configuration, see V2Ray Transport.</p>"},{"location":"configuration/inbound/tun/","title":"Tun","text":"<p>Only supported on Linux, Windows and macOS.</p>"},{"location":"configuration/inbound/tun/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"tun\",\n\"tag\": \"tun-in\",\n\"interface_name\": \"tun0\",\n\"inet4_address\": \"172.19.0.1/30\",\n\"inet6_address\": \"fdfe:dcba:9876::1/126\",\n\"mtu\": 9000,\n\"auto_route\": true,\n\"strict_route\": true,\n\"inet4_route_address\": [\n\"0.0.0.0/1\",\n\"128.0.0.0/1\"\n],\n\"inet6_route_address\": [\n\"::/1\",\n\"8000::/1\"\n],\n\"endpoint_independent_nat\": false,\n\"stack\": \"system\",\n\"include_uid\": [\n0\n],\n\"include_uid_range\": [\n\"1000-99999\"\n],\n\"exclude_uid\": [\n1000\n],\n\"exclude_uid_range\": [\n\"1000-99999\"\n],\n\"include_android_user\": [\n0,\n10\n],\n\"include_package\": [\n\"com.android.chrome\"\n],\n\"exclude_package\": [\n\"com.android.captiveportallogin\"\n],\n\"platform\": {\n\"http_proxy\": {\n\"enabled\": false,\n\"server\": \"127.0.0.1\",\n\"server_port\": 8080\n}\n},\n... // Listen Fields\n}\n</code></pre> <p>You can ignore the JSON Array [] tag when the content is only one item</p> <p>If tun is running in non-privileged mode, addresses and MTU will not be configured automatically, please make sure the settings are accurate.</p>"},{"location":"configuration/inbound/tun/#fields","title":"Fields","text":""},{"location":"configuration/inbound/tun/#interface_name","title":"interface_name","text":"<p>Virtual device name, automatically selected if empty.</p>"},{"location":"configuration/inbound/tun/#inet4_address","title":"inet4_address","text":"<p>Required</p> <p>IPv4 prefix for the tun interface.</p>"},{"location":"configuration/inbound/tun/#inet6_address","title":"inet6_address","text":"<p>IPv6 prefix for the tun interface.</p>"},{"location":"configuration/inbound/tun/#mtu","title":"mtu","text":"<p>The maximum transmission unit.</p>"},{"location":"configuration/inbound/tun/#auto_route","title":"auto_route","text":"<p>Set the default route to the Tun.</p> <p>To avoid traffic loopback, set <code>route.auto_detect_interface</code> or <code>route.default_interface</code> or <code>outbound.bind_interface</code></p> <p>Use with Android VPN</p> <p>By default, VPN takes precedence over tun. To make tun go through VPN, enable <code>route.override_android_vpn</code>.</p>"},{"location":"configuration/inbound/tun/#strict_route","title":"strict_route","text":"<p>Enforce strict routing rules when <code>auto_route</code> is enabled:</p> <p>In Linux:</p> <ul> <li>Let unsupported network unreachable</li> <li>Route all connections to tun</li> </ul> <p>It prevents address leaks and makes DNS hijacking work on Android, but your device will not be accessible by others.</p> <p>In Windows:</p> <ul> <li>Add firewall rules to prevent DNS leak caused by   Windows' ordinary multihomed DNS resolution behavior</li> </ul> <p>It may prevent some applications (such as VirtualBox) from working properly in certain situations.</p>"},{"location":"configuration/inbound/tun/#inet4_route_address","title":"inet4_route_address","text":"<p>Use custom routes instead of default when <code>auto_route</code> is enabled.</p>"},{"location":"configuration/inbound/tun/#inet6_route_address","title":"inet6_route_address","text":"<p>Use custom routes instead of default when <code>auto_route</code> is enabled.</p>"},{"location":"configuration/inbound/tun/#endpoint_independent_nat","title":"endpoint_independent_nat","text":"<p>This item is only available on the gvisor stack, other stacks are endpoint-independent NAT by default.</p> <p>Enable endpoint-independent NAT.</p> <p>Performance may degrade slightly, so it is not recommended to enable on when it is not needed.</p>"},{"location":"configuration/inbound/tun/#udp_timeout","title":"udp_timeout","text":"<p>UDP NAT expiration time in seconds, default is 300 (5 minutes).</p>"},{"location":"configuration/inbound/tun/#stack","title":"stack","text":"<p>TCP/IP stack.</p> Stack Description Status system (default) Sometimes better performance recommended gVisor Better compatibility, based on google/gvisor recommended LWIP Based on eycorsican/go-tun2socks upstream archived <p>gVisor and LWIP stacks is not included by default, see Installation.</p>"},{"location":"configuration/inbound/tun/#include_uid","title":"include_uid","text":"<p>UID rules are only supported on Linux and require auto_route.</p> <p>Limit users in route. Not limited by default.</p>"},{"location":"configuration/inbound/tun/#include_uid_range","title":"include_uid_range","text":"<p>Limit users in route, but in range.</p>"},{"location":"configuration/inbound/tun/#exclude_uid","title":"exclude_uid","text":"<p>Exclude users in route.</p>"},{"location":"configuration/inbound/tun/#exclude_uid_range","title":"exclude_uid_range","text":"<p>Exclude users in route, but in range.</p>"},{"location":"configuration/inbound/tun/#include_android_user","title":"include_android_user","text":"<p>Android user and package rules are only supported on Android and require auto_route.</p> <p>Limit android users in route.</p> Common user ID Main 0 Work Profile 10"},{"location":"configuration/inbound/tun/#include_package","title":"include_package","text":"<p>Limit android packages in route.</p>"},{"location":"configuration/inbound/tun/#exclude_package","title":"exclude_package","text":"<p>Exclude android packages in route.</p>"},{"location":"configuration/inbound/tun/#platform","title":"platform","text":"<p>Platform-specific settings, provided by client applications.</p>"},{"location":"configuration/inbound/tun/#platformhttp_proxy","title":"platform.http_proxy","text":"<p>System HTTP proxy settings.</p>"},{"location":"configuration/inbound/tun/#listen-fields","title":"Listen Fields","text":"<p>See Listen Fields for details.</p>"},{"location":"configuration/inbound/vless/","title":"VLESS","text":""},{"location":"configuration/inbound/vless/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"vless\",\n\"tag\": \"vless-in\",\n... // Listen Fields\n\"users\": [\n{\n\"name\": \"sekai\",\n\"uuid\": \"bf000d23-0752-40b4-affe-68f7707a9661\",\n\"flow\": \"\"\n}\n],\n\"tls\": {},\n\"transport\": {}\n}\n</code></pre>"},{"location":"configuration/inbound/vless/#listen-fields","title":"Listen Fields","text":"<p>See Listen Fields for details.</p>"},{"location":"configuration/inbound/vless/#fields","title":"Fields","text":""},{"location":"configuration/inbound/vless/#users","title":"users","text":"<p>Required</p> <p>VLESS users.</p>"},{"location":"configuration/inbound/vless/#usersuuid","title":"users.uuid","text":"<p>Required</p> <p>VLESS user id.</p>"},{"location":"configuration/inbound/vless/#usersflow","title":"users.flow","text":"<p>VLESS Sub-protocol.</p> <p>Available values:</p> <ul> <li><code>xtls-rprx-vision</code></li> </ul>"},{"location":"configuration/inbound/vless/#tls","title":"tls","text":"<p>TLS configuration, see TLS.</p>"},{"location":"configuration/inbound/vless/#transport","title":"transport","text":"<p>V2Ray Transport configuration, see V2Ray Transport.</p>"},{"location":"configuration/inbound/vmess/","title":"VMess","text":""},{"location":"configuration/inbound/vmess/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"vmess\",\n\"tag\": \"vmess-in\",\n... // Listen Fields\n\"users\": [\n{\n\"name\": \"sekai\",\n\"uuid\": \"bf000d23-0752-40b4-affe-68f7707a9661\",\n\"alterId\": 0\n}\n],\n\"tls\": {},\n\"transport\": {}\n}\n</code></pre>"},{"location":"configuration/inbound/vmess/#listen-fields","title":"Listen Fields","text":"<p>See Listen Fields for details.</p>"},{"location":"configuration/inbound/vmess/#fields","title":"Fields","text":""},{"location":"configuration/inbound/vmess/#users","title":"users","text":"<p>Required</p> <p>VMess users.</p> Alter ID Description 0 Disable legacy protocol &gt; 0 Enable legacy protocol <p>Legacy protocol support (VMess MD5 Authentication) is provided for compatibility purposes only, use of alterId &gt; 1 is not recommended.</p>"},{"location":"configuration/inbound/vmess/#tls","title":"tls","text":"<p>TLS configuration, see TLS.</p>"},{"location":"configuration/inbound/vmess/#transport","title":"transport","text":"<p>V2Ray Transport configuration, see V2Ray Transport.</p>"},{"location":"configuration/log/","title":"Log","text":""},{"location":"configuration/log/#structure","title":"Structure","text":"<pre><code>{\n\"log\": {\n\"disabled\": false,\n\"level\": \"info\",\n\"output\": \"box.log\",\n\"timestamp\": true\n}\n}\n</code></pre>"},{"location":"configuration/log/#fields","title":"Fields","text":""},{"location":"configuration/log/#disabled","title":"disabled","text":"<p>Disable logging, no output after start.</p>"},{"location":"configuration/log/#level","title":"level","text":"<p>Log level. One of: <code>trace</code> <code>debug</code> <code>info</code> <code>warn</code> <code>error</code> <code>fatal</code> <code>panic</code>.</p>"},{"location":"configuration/log/#output","title":"output","text":"<p>Output file path. Will not write log to console after enable.</p>"},{"location":"configuration/log/#timestamp","title":"timestamp","text":"<p>Add time to each line.</p>"},{"location":"configuration/ntp/","title":"NTP","text":"<p>Built-in NTP client service.</p> <p>If enabled, it will provide time for protocols like TLS/Shadowsocks/VMess, which is useful for environments where time synchronization is not possible.</p>"},{"location":"configuration/ntp/#structure","title":"Structure","text":"<pre><code>{\n\"ntp\": {\n\"enabled\": false,\n\"server\": \"time.apple.com\",\n\"server_port\": 123,\n\"interval\": \"30m\",\n... // Dial Fields\n}\n}\n</code></pre>"},{"location":"configuration/ntp/#fields","title":"Fields","text":""},{"location":"configuration/ntp/#enabled","title":"enabled","text":"<p>Enable NTP service.</p>"},{"location":"configuration/ntp/#server","title":"server","text":"<p>Required</p> <p>NTP server address.</p>"},{"location":"configuration/ntp/#server_port","title":"server_port","text":"<p>NTP server port.</p> <p>123 is used by default.</p>"},{"location":"configuration/ntp/#interval","title":"interval","text":"<p>Time synchronization interval.</p> <p>30 minutes is used by default.</p>"},{"location":"configuration/ntp/#dial-fields","title":"Dial Fields","text":"<p>See Dial Fields for details.</p>"},{"location":"configuration/outbound/","title":"Outbound","text":""},{"location":"configuration/outbound/#structure","title":"Structure","text":"<pre><code>{\n\"outbounds\": [\n{\n\"type\": \"\",\n\"tag\": \"\"\n}\n]\n}\n</code></pre>"},{"location":"configuration/outbound/#fields","title":"Fields","text":"Type Format <code>direct</code> Direct <code>block</code> Block <code>socks</code> SOCKS <code>http</code> HTTP <code>shadowsocks</code> Shadowsocks <code>vmess</code> VMess <code>trojan</code> Trojan <code>wireguard</code> Wireguard <code>hysteria</code> Hysteria <code>shadowsocksr</code> ShadowsocksR <code>vless</code> VLESS <code>shadowtls</code> ShadowTLS <code>tor</code> Tor <code>ssh</code> SSH <code>dns</code> DNS <code>selector</code> Selector <code>urltest</code> URLTest"},{"location":"configuration/outbound/#tag","title":"tag","text":"<p>The tag of the outbound.</p>"},{"location":"configuration/outbound/#features","title":"Features","text":""},{"location":"configuration/outbound/#outbounds-that-support-ip-connection","title":"Outbounds that support IP connection","text":"<ul> <li><code>WireGuard</code></li> </ul>"},{"location":"configuration/outbound/block/","title":"Block","text":"<p><code>block</code> outbound closes all incoming requests.</p>"},{"location":"configuration/outbound/block/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"block\",\n\"tag\": \"block\"\n}\n</code></pre>"},{"location":"configuration/outbound/block/#_1","title":"\u5b57\u6bb5","text":"<p>No fields.</p>"},{"location":"configuration/outbound/direct/","title":"Direct","text":"<p><code>direct</code> outbound send requests directly.</p>"},{"location":"configuration/outbound/direct/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"direct\",\n\"tag\": \"direct-out\",\n\"override_address\": \"1.0.0.1\",\n\"override_port\": 53,\n\"proxy_protocol\": 0,\n... // Dial Fields\n}\n</code></pre>"},{"location":"configuration/outbound/direct/#fields","title":"Fields","text":""},{"location":"configuration/outbound/direct/#override_address","title":"override_address","text":"<p>Override the connection destination address.</p>"},{"location":"configuration/outbound/direct/#override_port","title":"override_port","text":"<p>Override the connection destination port.</p>"},{"location":"configuration/outbound/direct/#proxy_protocol","title":"proxy_protocol","text":"<p>Write Proxy Protocol in the connection header.</p> <p>Protocol value can be <code>1</code> or <code>2</code>.</p>"},{"location":"configuration/outbound/direct/#dial-fields","title":"Dial Fields","text":"<p>See Dial Fields for details.</p>"},{"location":"configuration/outbound/dns/","title":"DNS","text":"<p><code>dns</code> outbound is a internal DNS server.</p>"},{"location":"configuration/outbound/dns/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"dns\",\n\"tag\": \"dns-out\"\n}\n</code></pre> <p>There are no outbound connections by the DNS outbound, all requests are handled internally.</p>"},{"location":"configuration/outbound/dns/#fields","title":"Fields","text":"<p>No fields.</p>"},{"location":"configuration/outbound/http/","title":"HTTP","text":"<p><code>http</code> outbound is a HTTP CONNECT proxy client.</p>"},{"location":"configuration/outbound/http/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"http\",\n\"tag\": \"http-out\",\n\"server\": \"127.0.0.1\",\n\"server_port\": 1080,\n\"username\": \"sekai\",\n\"password\": \"admin\",\n\"path\": \"\",\n\"headers\": {},\n\"tls\": {},\n... // Dial Fields\n}\n</code></pre>"},{"location":"configuration/outbound/http/#fields","title":"Fields","text":""},{"location":"configuration/outbound/http/#server","title":"server","text":"<p>Required</p> <p>The server address.</p>"},{"location":"configuration/outbound/http/#server_port","title":"server_port","text":"<p>Required</p> <p>The server port.</p>"},{"location":"configuration/outbound/http/#username","title":"username","text":"<p>Basic authorization username.</p>"},{"location":"configuration/outbound/http/#password","title":"password","text":"<p>Basic authorization password.</p>"},{"location":"configuration/outbound/http/#path","title":"path","text":"<p>Path of HTTP request.</p>"},{"location":"configuration/outbound/http/#headers","title":"headers","text":"<p>Extra headers of HTTP request.</p>"},{"location":"configuration/outbound/http/#tls","title":"tls","text":"<p>TLS configuration, see TLS.</p>"},{"location":"configuration/outbound/http/#dial-fields","title":"Dial Fields","text":"<p>See Dial Fields for details.</p>"},{"location":"configuration/outbound/hysteria/","title":"Hysteria","text":""},{"location":"configuration/outbound/hysteria/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"hysteria\",\n\"tag\": \"hysteria-out\",\n\"server\": \"127.0.0.1\",\n\"server_port\": 1080,\n\"up\": \"100 Mbps\",\n\"up_mbps\": 100,\n\"down\": \"100 Mbps\",\n\"down_mbps\": 100,\n\"obfs\": \"fuck me till the daylight\",\n\"auth\": \"\",\n\"auth_str\": \"password\",\n\"recv_window_conn\": 0,\n\"recv_window\": 0,\n\"disable_mtu_discovery\": false,\n\"network\": \"tcp\",\n\"tls\": {},\n... // Dial Fields\n}\n</code></pre> <p>QUIC, which is required by hysteria is not included by default, see Installation.</p>"},{"location":"configuration/outbound/hysteria/#fields","title":"Fields","text":""},{"location":"configuration/outbound/hysteria/#server","title":"server","text":"<p>Required</p> <p>The server address.</p>"},{"location":"configuration/outbound/hysteria/#server_port","title":"server_port","text":"<p>Required</p> <p>The server port.</p>"},{"location":"configuration/outbound/hysteria/#up-down","title":"up, down","text":"<p>Required</p> <p>Format: <code>[Integer] [Unit]</code> e.g. <code>100 Mbps, 640 KBps, 2 Gbps</code></p> <p>Supported units (case sensitive, b = bits, B = bytes, 8b=1B):</p> <pre><code>bps (bits per second)\nBps (bytes per second)\nKbps (kilobits per second)\nKBps (kilobytes per second)\nMbps (megabits per second)\nMBps (megabytes per second)\nGbps (gigabits per second)\nGBps (gigabytes per second)\nTbps (terabits per second)\nTBps (terabytes per second)\n</code></pre>"},{"location":"configuration/outbound/hysteria/#up_mbps-down_mbps","title":"up_mbps, down_mbps","text":"<p>Required</p> <p><code>up, down</code> in Mbps.</p>"},{"location":"configuration/outbound/hysteria/#obfs","title":"obfs","text":"<p>Obfuscated password.</p>"},{"location":"configuration/outbound/hysteria/#auth","title":"auth","text":"<p>Authentication password, in base64.</p>"},{"location":"configuration/outbound/hysteria/#auth_str","title":"auth_str","text":"<p>Authentication password.</p>"},{"location":"configuration/outbound/hysteria/#recv_window_conn","title":"recv_window_conn","text":"<p>The QUIC stream-level flow control window for receiving data.</p> <p><code>15728640 (15 MB/s)</code> will be used if empty.</p>"},{"location":"configuration/outbound/hysteria/#recv_window","title":"recv_window","text":"<p>The QUIC connection-level flow control window for receiving data.</p> <p><code>67108864 (64 MB/s)</code> will be used if empty.</p>"},{"location":"configuration/outbound/hysteria/#disable_mtu_discovery","title":"disable_mtu_discovery","text":"<p>Disables Path MTU Discovery (RFC 8899). Packets will then be at most 1252 (IPv4) / 1232 (IPv6) bytes in size.</p> <p>Force enabled on for systems other than Linux and Windows (according to upstream).</p>"},{"location":"configuration/outbound/hysteria/#tls","title":"tls","text":"<p>Required</p> <p>TLS configuration, see TLS.</p>"},{"location":"configuration/outbound/hysteria/#network","title":"network","text":"<p>Enabled network</p> <p>One of <code>tcp</code> <code>udp</code>.</p> <p>Both is enabled by default.</p>"},{"location":"configuration/outbound/hysteria/#dial-fields","title":"Dial Fields","text":"<p>See Dial Fields for details.</p>"},{"location":"configuration/outbound/selector/","title":"Selector","text":""},{"location":"configuration/outbound/selector/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"selector\",\n\"tag\": \"select\",\n\"outbounds\": [\n\"proxy-a\",\n\"proxy-b\",\n\"proxy-c\"\n],\n\"default\": \"proxy-c\"\n}\n</code></pre> <p>The selector can only be controlled through the Clash API currently.</p>"},{"location":"configuration/outbound/selector/#fields","title":"Fields","text":""},{"location":"configuration/outbound/selector/#outbounds","title":"outbounds","text":"<p>Required</p> <p>List of outbound tags to select.</p>"},{"location":"configuration/outbound/selector/#default","title":"default","text":"<p>The default outbound tag. The first outbound will be used if empty.</p>"},{"location":"configuration/outbound/shadowsocks/","title":"Shadowsocks","text":""},{"location":"configuration/outbound/shadowsocks/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"shadowsocks\",\n\"tag\": \"ss-out\",\n\"server\": \"127.0.0.1\",\n\"server_port\": 1080,\n\"method\": \"2022-blake3-aes-128-gcm\",\n\"password\": \"8JCsPssfgS8tiRwiMlhARg==\",\n\"plugin\": \"\",\n\"plugin_opts\": \"\",\n\"network\": \"udp\",\n\"udp_over_tcp\": false | {},\n\"multiplex\": {},\n... // Dial Fields\n}\n</code></pre>"},{"location":"configuration/outbound/shadowsocks/#fields","title":"Fields","text":""},{"location":"configuration/outbound/shadowsocks/#server","title":"server","text":"<p>Required</p> <p>The server address.</p>"},{"location":"configuration/outbound/shadowsocks/#server_port","title":"server_port","text":"<p>Required</p> <p>The server port.</p>"},{"location":"configuration/outbound/shadowsocks/#method","title":"method","text":"<p>Required</p> <p>Encryption methods:</p> <ul> <li><code>2022-blake3-aes-128-gcm</code></li> <li><code>2022-blake3-aes-256-gcm</code></li> <li><code>2022-blake3-chacha20-poly1305</code></li> <li><code>none</code></li> <li><code>aes-128-gcm</code></li> <li><code>aes-192-gcm</code></li> <li><code>aes-256-gcm</code></li> <li><code>chacha20-ietf-poly1305</code></li> <li><code>xchacha20-ietf-poly1305</code></li> </ul> <p>Legacy encryption methods:</p> <ul> <li><code>aes-128-ctr</code></li> <li><code>aes-192-ctr</code></li> <li><code>aes-256-ctr</code></li> <li><code>aes-128-cfb</code></li> <li><code>aes-192-cfb</code></li> <li><code>aes-256-cfb</code></li> <li><code>rc4-md5</code></li> <li><code>chacha20-ietf</code></li> <li><code>xchacha20</code></li> </ul>"},{"location":"configuration/outbound/shadowsocks/#password","title":"password","text":"<p>Required</p> <p>The shadowsocks password.</p>"},{"location":"configuration/outbound/shadowsocks/#plugin","title":"plugin","text":"<p>Shadowsocks SIP003 plugin, implemented in internal.</p> <p>Only <code>obfs-local</code> and <code>v2ray-plugin</code> are supported.</p>"},{"location":"configuration/outbound/shadowsocks/#plugin_opts","title":"plugin_opts","text":"<p>Shadowsocks SIP003 plugin options.</p>"},{"location":"configuration/outbound/shadowsocks/#network","title":"network","text":"<p>Enabled network</p> <p>One of <code>tcp</code> <code>udp</code>.</p> <p>Both is enabled by default.</p>"},{"location":"configuration/outbound/shadowsocks/#udp_over_tcp","title":"udp_over_tcp","text":"<p>UDP over TCP configuration.</p> <p>See UDP Over TCP for details.</p> <p>Conflict with <code>multiplex</code>.</p>"},{"location":"configuration/outbound/shadowsocks/#multiplex","title":"multiplex","text":"<p>Multiplex configuration, see Multiplex.</p>"},{"location":"configuration/outbound/shadowsocks/#dial-fields","title":"Dial Fields","text":"<p>See Dial Fields for details.</p>"},{"location":"configuration/outbound/shadowsocksr/","title":"ShadowsocksR","text":""},{"location":"configuration/outbound/shadowsocksr/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"shadowsocksr\",\n\"tag\": \"ssr-out\",\n\"server\": \"127.0.0.1\",\n\"server_port\": 1080,\n\"method\": \"aes-128-cfb\",\n\"password\": \"8JCsPssfgS8tiRwiMlhARg==\",\n\"obfs\": \"plain\",\n\"obfs_param\": \"\",\n\"protocol\": \"origin\",\n\"protocol_param\": \"\",\n\"network\": \"udp\",\n... // Dial Fields\n}\n</code></pre> <p>The ShadowsocksR protocol is obsolete and unmaintained. This outbound is provided for compatibility only.</p> <p>ShadowsocksR is not included by default, see Installation.</p>"},{"location":"configuration/outbound/shadowsocksr/#fields","title":"Fields","text":""},{"location":"configuration/outbound/shadowsocksr/#server","title":"server","text":"<p>Required</p> <p>The server address.</p>"},{"location":"configuration/outbound/shadowsocksr/#server_port","title":"server_port","text":"<p>Required</p> <p>The server port.</p>"},{"location":"configuration/outbound/shadowsocksr/#method","title":"method","text":"<p>Required</p> <p>Encryption methods:</p> <ul> <li><code>aes-128-ctr</code></li> <li><code>aes-192-ctr</code></li> <li><code>aes-256-ctr</code></li> <li><code>aes-128-cfb</code></li> <li><code>aes-192-cfb</code></li> <li><code>aes-256-cfb</code></li> <li><code>rc4-md5</code></li> <li><code>chacha20-ietf</code></li> <li><code>xchacha20</code></li> </ul>"},{"location":"configuration/outbound/shadowsocksr/#password","title":"password","text":"<p>Required</p> <p>The shadowsocks password.</p>"},{"location":"configuration/outbound/shadowsocksr/#obfs","title":"obfs","text":"<p>The ShadowsocksR obfuscate.</p> <ul> <li>plain</li> <li>http_simple</li> <li>http_post</li> <li>random_head</li> <li>tls1.2_ticket_auth</li> </ul>"},{"location":"configuration/outbound/shadowsocksr/#obfs_param","title":"obfs_param","text":"<p>The ShadowsocksR obfuscate parameter.</p>"},{"location":"configuration/outbound/shadowsocksr/#protocol","title":"protocol","text":"<p>The ShadowsocksR protocol.</p> <ul> <li>origin</li> <li>verify_sha1</li> <li>auth_sha1_v4</li> <li>auth_aes128_md5</li> <li>auth_aes128_sha1</li> <li>auth_chain_a</li> <li>auth_chain_b</li> </ul>"},{"location":"configuration/outbound/shadowsocksr/#protocol_param","title":"protocol_param","text":"<p>The ShadowsocksR protocol parameter.</p>"},{"location":"configuration/outbound/shadowsocksr/#network","title":"network","text":"<p>Enabled network</p> <p>One of <code>tcp</code> <code>udp</code>.</p> <p>Both is enabled by default.</p>"},{"location":"configuration/outbound/shadowsocksr/#dial-fields","title":"Dial Fields","text":"<p>See Dial Fields for details.</p>"},{"location":"configuration/outbound/shadowtls/","title":"ShadowTLS","text":""},{"location":"configuration/outbound/shadowtls/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"shadowtls\",\n\"tag\": \"st-out\",\n\"server\": \"127.0.0.1\",\n\"server_port\": 1080,\n\"version\": 3,\n\"password\": \"fuck me till the daylight\",\n\"tls\": {},\n... // Dial Fields\n}\n</code></pre>"},{"location":"configuration/outbound/shadowtls/#fields","title":"Fields","text":""},{"location":"configuration/outbound/shadowtls/#server","title":"server","text":"<p>Required</p> <p>The server address.</p>"},{"location":"configuration/outbound/shadowtls/#server_port","title":"server_port","text":"<p>Required</p> <p>The server port.</p>"},{"location":"configuration/outbound/shadowtls/#version","title":"version","text":"<p>ShadowTLS protocol version.</p> Value Protocol Version <code>1</code> (default) ShadowTLS v1 <code>2</code> ShadowTLS v2 <code>3</code> ShadowTLS v3"},{"location":"configuration/outbound/shadowtls/#password","title":"password","text":"<p>Set password.</p> <p>Only available in the ShadowTLS v2/v3 protocol.</p>"},{"location":"configuration/outbound/shadowtls/#tls","title":"tls","text":"<p>Required</p> <p>TLS configuration, see TLS.</p>"},{"location":"configuration/outbound/shadowtls/#dial-fields","title":"Dial Fields","text":"<p>See Dial Fields for details.</p>"},{"location":"configuration/outbound/socks/","title":"SOCKS","text":"<p><code>socks</code> outbound is a socks4/socks4a/socks5 client.</p>"},{"location":"configuration/outbound/socks/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"socks\",\n\"tag\": \"socks-out\",\n\"server\": \"127.0.0.1\",\n\"server_port\": 1080,\n\"version\": \"5\",\n\"username\": \"sekai\",\n\"password\": \"admin\",\n\"network\": \"udp\",\n\"udp_over_tcp\": false | {},\n... // Dial Fields\n}\n</code></pre>"},{"location":"configuration/outbound/socks/#fields","title":"Fields","text":""},{"location":"configuration/outbound/socks/#server","title":"server","text":"<p>Required</p> <p>The server address.</p>"},{"location":"configuration/outbound/socks/#server_port","title":"server_port","text":"<p>Required</p> <p>The server port.</p>"},{"location":"configuration/outbound/socks/#version","title":"version","text":"<p>The SOCKS version, one of <code>4</code> <code>4a</code> <code>5</code>.</p> <p>SOCKS5 used by default.</p>"},{"location":"configuration/outbound/socks/#username","title":"username","text":"<p>SOCKS username.</p>"},{"location":"configuration/outbound/socks/#password","title":"password","text":"<p>SOCKS5 password.</p>"},{"location":"configuration/outbound/socks/#network","title":"network","text":"<p>Enabled network</p> <p>One of <code>tcp</code> <code>udp</code>.</p> <p>Both is enabled by default.</p>"},{"location":"configuration/outbound/socks/#udp_over_tcp","title":"udp_over_tcp","text":"<p>UDP over TCP protocol settings.</p> <p>See UDP Over TCP for details.</p>"},{"location":"configuration/outbound/socks/#dial-fields","title":"Dial Fields","text":"<p>See Dial Fields for details.</p>"},{"location":"configuration/outbound/ssh/","title":"SSH","text":""},{"location":"configuration/outbound/ssh/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"ssh\",\n\"tag\": \"ssh-out\",\n\"server\": \"127.0.0.1\",\n\"server_port\": 22,\n\"user\": \"root\",\n\"password\": \"admin\",\n\"private_key\": \"\",\n\"private_key_path\": \"$HOME/.ssh/id_rsa\",\n\"private_key_passphrase\": \"\",\n\"host_key\": [\n\"ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdH...\"\n],\n\"host_key_algorithms\": [],\n\"client_version\": \"SSH-2.0-OpenSSH_7.4p1\",\n... // Dial Fields\n}\n</code></pre>"},{"location":"configuration/outbound/ssh/#fields","title":"Fields","text":""},{"location":"configuration/outbound/ssh/#server","title":"server","text":"<p>Required</p> <p>Server address.</p>"},{"location":"configuration/outbound/ssh/#server_port","title":"server_port","text":"<p>Server port. 22 will be used if empty.</p>"},{"location":"configuration/outbound/ssh/#user","title":"user","text":"<p>SSH user, root will be used if empty.</p>"},{"location":"configuration/outbound/ssh/#password","title":"password","text":"<p>Password.</p>"},{"location":"configuration/outbound/ssh/#private_key","title":"private_key","text":"<p>Private key.</p>"},{"location":"configuration/outbound/ssh/#private_key_path","title":"private_key_path","text":"<p>Private key path.</p>"},{"location":"configuration/outbound/ssh/#private_key_passphrase","title":"private_key_passphrase","text":"<p>Private key passphrase.</p>"},{"location":"configuration/outbound/ssh/#host_key","title":"host_key","text":"<p>Host key. Accept any if empty.</p>"},{"location":"configuration/outbound/ssh/#host_key_algorithms","title":"host_key_algorithms","text":"<p>Host key algorithms.</p>"},{"location":"configuration/outbound/ssh/#client_version","title":"client_version","text":"<p>Client version. Random version will be used if empty.</p>"},{"location":"configuration/outbound/ssh/#dial-fields","title":"Dial Fields","text":"<p>See Dial Fields for details.</p>"},{"location":"configuration/outbound/tor/","title":"Tor","text":""},{"location":"configuration/outbound/tor/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"tor\",\n\"tag\": \"tor-out\",\n\"executable_path\": \"/usr/bin/tor\",\n\"extra_args\": [],\n\"data_directory\": \"$HOME/.cache/tor\",\n\"torrc\": {\n\"ClientOnly\": 1\n},\n... // Dial Fields\n}\n</code></pre> <p>Embedded tor is not included by default, see Installation.</p>"},{"location":"configuration/outbound/tor/#fields","title":"Fields","text":""},{"location":"configuration/outbound/tor/#executable_path","title":"executable_path","text":"<p>The path to the Tor executable.</p> <p>Embedded Tor will be ignored if set.</p>"},{"location":"configuration/outbound/tor/#extra_args","title":"extra_args","text":"<p>List of extra arguments passed to the Tor instance when started.</p>"},{"location":"configuration/outbound/tor/#data_directory","title":"data_directory","text":"<p>Recommended</p> <p>The data directory of Tor.</p> <p>Each start will be very slow if not specified.</p>"},{"location":"configuration/outbound/tor/#torrc","title":"torrc","text":"<p>Map of torrc options.</p> <p>See tor(1) for details.</p>"},{"location":"configuration/outbound/tor/#dial-fields","title":"Dial Fields","text":"<p>See Dial Fields for details.</p>"},{"location":"configuration/outbound/trojan/","title":"Trojan","text":""},{"location":"configuration/outbound/trojan/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"trojan\",\n\"tag\": \"trojan-out\",\n\"server\": \"127.0.0.1\",\n\"server_port\": 1080,\n\"password\": \"8JCsPssfgS8tiRwiMlhARg==\",\n\"network\": \"tcp\",\n\"tls\": {},\n\"multiplex\": {},\n\"transport\": {},\n... // Dial Fields\n}\n</code></pre>"},{"location":"configuration/outbound/trojan/#fields","title":"Fields","text":""},{"location":"configuration/outbound/trojan/#server","title":"server","text":"<p>Required</p> <p>The server address.</p>"},{"location":"configuration/outbound/trojan/#server_port","title":"server_port","text":"<p>Required</p> <p>The server port.</p>"},{"location":"configuration/outbound/trojan/#password","title":"password","text":"<p>Required</p> <p>The Trojan password.</p>"},{"location":"configuration/outbound/trojan/#network","title":"network","text":"<p>Enabled network</p> <p>One of <code>tcp</code> <code>udp</code>.</p> <p>Both is enabled by default.</p>"},{"location":"configuration/outbound/trojan/#tls","title":"tls","text":"<p>TLS configuration, see TLS.</p>"},{"location":"configuration/outbound/trojan/#multiplex","title":"multiplex","text":"<p>Multiplex configuration, see Multiplex.</p>"},{"location":"configuration/outbound/trojan/#transport","title":"transport","text":"<p>V2Ray Transport configuration, see V2Ray Transport.</p>"},{"location":"configuration/outbound/trojan/#dial-fields","title":"Dial Fields","text":"<p>See Dial Fields for details.</p>"},{"location":"configuration/outbound/urltest/","title":"URLTest","text":""},{"location":"configuration/outbound/urltest/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"urltest\",\n\"tag\": \"auto\",\n\"outbounds\": [\n\"proxy-a\",\n\"proxy-b\",\n\"proxy-c\"\n],\n\"url\": \"https://www.gstatic.com/generate_204\",\n\"interval\": \"1m\",\n\"tolerance\": 50\n}\n</code></pre>"},{"location":"configuration/outbound/urltest/#fields","title":"Fields","text":""},{"location":"configuration/outbound/urltest/#outbounds","title":"outbounds","text":"<p>Required</p> <p>List of outbound tags to test.</p>"},{"location":"configuration/outbound/urltest/#url","title":"url","text":"<p>The URL to test. <code>https://www.gstatic.com/generate_204</code> will be used if empty.</p>"},{"location":"configuration/outbound/urltest/#interval","title":"interval","text":"<p>The test interval. <code>1m</code> will be used if empty.</p>"},{"location":"configuration/outbound/urltest/#tolerance","title":"tolerance","text":"<p>The test tolerance in milliseconds. <code>50</code> will be used if empty.</p>"},{"location":"configuration/outbound/vless/","title":"VLESS","text":""},{"location":"configuration/outbound/vless/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"vless\",\n\"tag\": \"vless-out\",\n\"server\": \"127.0.0.1\",\n\"server_port\": 1080,\n\"uuid\": \"bf000d23-0752-40b4-affe-68f7707a9661\",\n\"flow\": \"xtls-rprx-vision\",\n\"network\": \"tcp\",\n\"tls\": {},\n\"packet_encoding\": \"\",\n\"transport\": {},\n... // Dial Fields\n}\n</code></pre>"},{"location":"configuration/outbound/vless/#fields","title":"Fields","text":""},{"location":"configuration/outbound/vless/#server","title":"server","text":"<p>Required</p> <p>The server address.</p>"},{"location":"configuration/outbound/vless/#server_port","title":"server_port","text":"<p>Required</p> <p>The server port.</p>"},{"location":"configuration/outbound/vless/#uuid","title":"uuid","text":"<p>Required</p> <p>VLESS user id.</p>"},{"location":"configuration/outbound/vless/#flow","title":"flow","text":"<p>VLESS Sub-protocol.</p> <p>Available values:</p> <ul> <li><code>xtls-rprx-vision</code></li> </ul>"},{"location":"configuration/outbound/vless/#network","title":"network","text":"<p>Enabled network</p> <p>One of <code>tcp</code> <code>udp</code>.</p> <p>Both is enabled by default.</p>"},{"location":"configuration/outbound/vless/#tls","title":"tls","text":"<p>TLS configuration, see TLS.</p>"},{"location":"configuration/outbound/vless/#packet_encoding","title":"packet_encoding","text":"<p>UDP packet encoding, xudp is used by default.</p> Encoding Description (none) Disabled packetaddr Supported by v2ray 5+ xudp Supported by xray"},{"location":"configuration/outbound/vless/#transport","title":"transport","text":"<p>V2Ray Transport configuration, see V2Ray Transport.</p>"},{"location":"configuration/outbound/vless/#dial-fields","title":"Dial Fields","text":"<p>See Dial Fields for details.</p>"},{"location":"configuration/outbound/vmess/","title":"VMess","text":""},{"location":"configuration/outbound/vmess/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"vmess\",\n\"tag\": \"vmess-out\",\n\"server\": \"127.0.0.1\",\n\"server_port\": 1080,\n\"uuid\": \"bf000d23-0752-40b4-affe-68f7707a9661\",\n\"security\": \"auto\",\n\"alter_id\": 0,\n\"global_padding\": false,\n\"authenticated_length\": true,\n\"network\": \"tcp\",\n\"tls\": {},\n\"packet_encoding\": \"\",\n\"multiplex\": {},\n\"transport\": {},\n... // Dial Fields\n}\n</code></pre>"},{"location":"configuration/outbound/vmess/#fields","title":"Fields","text":""},{"location":"configuration/outbound/vmess/#server","title":"server","text":"<p>Required</p> <p>The server address.</p>"},{"location":"configuration/outbound/vmess/#server_port","title":"server_port","text":"<p>Required</p> <p>The server port.</p>"},{"location":"configuration/outbound/vmess/#uuid","title":"uuid","text":"<p>Required</p> <p>The VMess user id.</p>"},{"location":"configuration/outbound/vmess/#security","title":"security","text":"<p>Encryption methods:</p> <ul> <li><code>auto</code></li> <li><code>none</code></li> <li><code>zero</code></li> <li><code>aes-128-gcm</code></li> <li><code>chacha20-poly1305</code></li> </ul> <p>Legacy encryption methods:</p> <ul> <li><code>aes-128-ctr</code></li> </ul>"},{"location":"configuration/outbound/vmess/#alter_id","title":"alter_id","text":"Alter ID Description 0 Use AEAD protocol 1 Use legacy protocol &gt; 1 Unused, same as 1"},{"location":"configuration/outbound/vmess/#global_padding","title":"global_padding","text":"<p>Protocol parameter. Will waste traffic randomly if enabled (enabled by default in v2ray and cannot be disabled).</p>"},{"location":"configuration/outbound/vmess/#authenticated_length","title":"authenticated_length","text":"<p>Protocol parameter. Enable length block encryption.</p>"},{"location":"configuration/outbound/vmess/#network","title":"network","text":"<p>Enabled network</p> <p>One of <code>tcp</code> <code>udp</code>.</p> <p>Both is enabled by default.</p>"},{"location":"configuration/outbound/vmess/#tls","title":"tls","text":"<p>TLS configuration, see TLS.</p>"},{"location":"configuration/outbound/vmess/#packet_encoding","title":"packet_encoding","text":"<p>UDP packet encoding.</p> Encoding Description (none) Disabled packetaddr Supported by v2ray 5+ xudp Supported by xray"},{"location":"configuration/outbound/vmess/#multiplex","title":"multiplex","text":"<p>Multiplex configuration, see Multiplex.</p>"},{"location":"configuration/outbound/vmess/#transport","title":"transport","text":"<p>V2Ray Transport configuration, see V2Ray Transport.</p>"},{"location":"configuration/outbound/vmess/#dial-fields","title":"Dial Fields","text":"<p>See Dial Fields for details.</p>"},{"location":"configuration/outbound/wireguard/","title":"WireGuard","text":""},{"location":"configuration/outbound/wireguard/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"wireguard\",\n\"tag\": \"wireguard-out\",\n\"server\": \"127.0.0.1\",\n\"server_port\": 1080,\n\"system_interface\": false,\n\"interface_name\": \"wg0\",\n\"local_address\": [\n\"10.0.0.2/32\"\n],\n\"private_key\": \"YNXtAzepDqRv9H52osJVDQnznT5AM11eCK3ESpwSt04=\",\n\"peers\": [\n{\n\"server\": \"127.0.0.1\",\n\"server_port\": 1080,\n\"public_key\": \"Z1XXLsKYkYxuiYjJIkRvtIKFepCYHTgON+GwPq7SOV4=\",\n\"pre_shared_key\": \"31aIhAPwktDGpH4JDhA8GNvjFXEf/a6+UaQRyOAiyfM=\",\n\"allowed_ips\": [\n\"0.0.0.0/0\"\n],\n\"reserved\": [0, 0, 0]\n}\n],\n\"peer_public_key\": \"Z1XXLsKYkYxuiYjJIkRvtIKFepCYHTgON+GwPq7SOV4=\",\n\"pre_shared_key\": \"31aIhAPwktDGpH4JDhA8GNvjFXEf/a6+UaQRyOAiyfM=\",\n\"reserved\": [0, 0, 0],\n\"workers\": 4,\n\"mtu\": 1408,\n\"network\": \"tcp\",\n... // Dial Fields\n}\n</code></pre> <p>WireGuard is not included by default, see Installation.</p> <p>gVisor, which is required by the unprivileged WireGuard is not included by default, see Installation.</p>"},{"location":"configuration/outbound/wireguard/#fields","title":"Fields","text":""},{"location":"configuration/outbound/wireguard/#server","title":"server","text":"<p>Required if multi-peer disabled</p> <p>The server address.</p>"},{"location":"configuration/outbound/wireguard/#server_port","title":"server_port","text":"<p>Required if multi-peer disabled</p> <p>The server port.</p>"},{"location":"configuration/outbound/wireguard/#system_interface","title":"system_interface","text":"<p>Use system tun support.</p> <p>Requires privilege and cannot conflict with system interfaces.</p> <p>Forced if gVisor not included in the build.</p>"},{"location":"configuration/outbound/wireguard/#interface_name","title":"interface_name","text":"<p>Custom device name when <code>system_interface</code> enabled.</p>"},{"location":"configuration/outbound/wireguard/#local_address","title":"local_address","text":"<p>Required</p> <p>List of IP (v4 or v6) address prefixes to be assigned to the interface.</p>"},{"location":"configuration/outbound/wireguard/#private_key","title":"private_key","text":"<p>Required</p> <p>WireGuard requires base64-encoded public and private keys. These can be generated using the wg(8) utility:</p> <pre><code>wg genkey\necho \"private key\" || wg pubkey\n</code></pre>"},{"location":"configuration/outbound/wireguard/#peers","title":"peers","text":"<p>Multi-peer support. </p> <p>If enabled, <code>server, server_port, peer_public_key, pre_shared_key</code> will be ignored.</p>"},{"location":"configuration/outbound/wireguard/#peersallowed_ips","title":"peers.allowed_ips","text":"<p>WireGuard allowed IPs.</p>"},{"location":"configuration/outbound/wireguard/#peersreserved","title":"peers.reserved","text":"<p>WireGuard reserved field bytes.</p> <p><code>$outbound.reserved</code> will be used if empty.</p>"},{"location":"configuration/outbound/wireguard/#peer_public_key","title":"peer_public_key","text":"<p>Required if multi-peer disabled</p> <p>WireGuard peer public key.</p>"},{"location":"configuration/outbound/wireguard/#pre_shared_key","title":"pre_shared_key","text":"<p>WireGuard pre-shared key.</p>"},{"location":"configuration/outbound/wireguard/#reserved","title":"reserved","text":"<p>WireGuard reserved field bytes.</p>"},{"location":"configuration/outbound/wireguard/#workers","title":"workers","text":"<p>WireGuard worker count.</p> <p>CPU count is used by default.</p>"},{"location":"configuration/outbound/wireguard/#mtu","title":"mtu","text":"<p>WireGuard MTU.</p> <p>1408 will be used if empty.</p>"},{"location":"configuration/outbound/wireguard/#network","title":"network","text":"<p>Enabled network</p> <p>One of <code>tcp</code> <code>udp</code>.</p> <p>Both is enabled by default.</p>"},{"location":"configuration/outbound/wireguard/#dial-fields","title":"Dial Fields","text":"<p>See Dial Fields for details.</p>"},{"location":"configuration/route/","title":"Route","text":""},{"location":"configuration/route/#structure","title":"Structure","text":"<pre><code>{\n\"route\": {\n\"geoip\": {},\n\"geosite\": {},\n\"rules\": [],\n\"final\": \"\",\n\"auto_detect_interface\": false,\n\"override_android_vpn\": false,\n\"default_interface\": \"en0\",\n\"default_mark\": 233\n}\n}\n</code></pre>"},{"location":"configuration/route/#fields","title":"Fields","text":"Key Format <code>geoip</code> GeoIP <code>geosite</code> Geosite <code>rules</code> List of Route Rule"},{"location":"configuration/route/#final","title":"final","text":"<p>Default outbound tag. the first outbound will be used if empty.</p>"},{"location":"configuration/route/#auto_detect_interface","title":"auto_detect_interface","text":"<p>Only supported on Linux, Windows and macOS.</p> <p>Bind outbound connections to the default NIC by default to prevent routing loops under tun.</p> <p>Takes no effect if <code>outbound.bind_interface</code> is set.</p>"},{"location":"configuration/route/#override_android_vpn","title":"override_android_vpn","text":"<p>Only supported on Android.</p> <p>Accept Android VPN as upstream NIC when <code>auto_detect_interface</code> enabled.</p>"},{"location":"configuration/route/#default_interface","title":"default_interface","text":"<p>Only supported on Linux, Windows and macOS.</p> <p>Bind outbound connections to the specified NIC by default to prevent routing loops under tun.</p> <p>Takes no effect if <code>auto_detect_interface</code> is set.</p>"},{"location":"configuration/route/#default_mark","title":"default_mark","text":"<p>Only supported on Linux.</p> <p>Set routing mark by default.</p> <p>Takes no effect if <code>outbound.routing_mark</code> is set.</p>"},{"location":"configuration/route/geoip/","title":"GeoIP","text":""},{"location":"configuration/route/geoip/#structure","title":"Structure","text":"<pre><code>{\n\"route\": {\n\"geoip\": {\n\"path\": \"\",\n\"download_url\": \"\",\n\"download_detour\": \"\"\n}\n}\n}\n</code></pre>"},{"location":"configuration/route/geoip/#fields","title":"Fields","text":""},{"location":"configuration/route/geoip/#path","title":"path","text":"<p>The path to the sing-geoip database.</p> <p><code>geoip.db</code> will be used if empty.</p>"},{"location":"configuration/route/geoip/#download_url","title":"download_url","text":"<p>The download URL of the sing-geoip database.</p> <p>Default is <code>https://github.com/SagerNet/sing-geoip/releases/latest/download/geoip.db</code>.</p>"},{"location":"configuration/route/geoip/#download_detour","title":"download_detour","text":"<p>The tag of the outbound to download the database.</p> <p>Default outbound will be used if empty.</p>"},{"location":"configuration/route/geosite/","title":"Geosite","text":""},{"location":"configuration/route/geosite/#structure","title":"Structure","text":"<pre><code>{\n\"route\": {\n\"geosite\": {\n\"path\": \"\",\n\"download_url\": \"\",\n\"download_detour\": \"\"\n}\n}\n}\n</code></pre>"},{"location":"configuration/route/geosite/#fields","title":"Fields","text":""},{"location":"configuration/route/geosite/#path","title":"path","text":"<p>The path to the sing-geosite database.</p> <p><code>geosite.db</code> will be used if empty.</p>"},{"location":"configuration/route/geosite/#download_url","title":"download_url","text":"<p>The download URL of the sing-geoip database.</p> <p>Default is <code>https://github.com/SagerNet/sing-geosite/releases/latest/download/geosite.db</code>.</p>"},{"location":"configuration/route/geosite/#download_detour","title":"download_detour","text":"<p>The tag of the outbound to download the database.</p> <p>Default outbound will be used if empty.</p>"},{"location":"configuration/route/ip-rule/","title":"Ip rule","text":""},{"location":"configuration/route/ip-rule/#structure","title":"Structure","text":"<pre><code>{\n\"route\": {\n\"ip_rules\": [\n{\n\"inbound\": [\n\"mixed-in\"\n],\n\"ip_version\": 6,\n\"network\": [\n\"tcp\"\n],\n\"domain\": [\n\"test.com\"\n],\n\"domain_suffix\": [\n\".cn\"\n],\n\"domain_keyword\": [\n\"test\"\n],\n\"domain_regex\": [\n\"^stun\\\\..+\"\n],\n\"geosite\": [\n\"cn\"\n],\n\"source_geoip\": [\n\"private\"\n],\n\"geoip\": [\n\"cn\"\n],\n\"source_ip_cidr\": [\n\"10.0.0.0/24\",\n\"192.168.0.1\"\n],\n\"ip_cidr\": [\n\"10.0.0.0/24\",\n\"192.168.0.1\"\n],\n\"source_port\": [\n12345\n],\n\"source_port_range\": [\n\"1000:2000\",\n\":3000\",\n\"4000:\"\n],\n\"port\": [\n80,\n443\n],\n\"port_range\": [\n\"1000:2000\",\n\":3000\",\n\"4000:\"\n],\n\"invert\": false,\n\"action\": \"direct\",\n\"outbound\": \"wireguard\"\n},\n{\n\"type\": \"logical\",\n\"mode\": \"and\",\n\"rules\": [],\n\"invert\": false,\n\"action\": \"direct\",\n\"outbound\": \"wireguard\"\n}\n]\n}\n}\n</code></pre> <p>You can ignore the JSON Array [] tag when the content is only one item</p>"},{"location":"configuration/route/ip-rule/#default-fields","title":"Default Fields","text":"<p>The default rule uses the following matching logic: (<code>domain</code> || <code>domain_suffix</code> || <code>domain_keyword</code> || <code>domain_regex</code> || <code>geosite</code> || <code>geoip</code> || <code>ip_cidr</code>) &amp;&amp; (<code>port</code> || <code>port_range</code>) &amp;&amp; (<code>source_geoip</code> || <code>source_ip_cidr</code>) &amp;&amp; (<code>source_port</code> || <code>source_port_range</code>) &amp;&amp; <code>other fields</code></p>"},{"location":"configuration/route/ip-rule/#inbound","title":"inbound","text":"<p>Tags of Inbound.</p>"},{"location":"configuration/route/ip-rule/#ip_version","title":"ip_version","text":"<p>4 or 6.</p> <p>Not limited if empty.</p>"},{"location":"configuration/route/ip-rule/#network","title":"network","text":"<p>Match network protocol.</p> <p>Available values:</p> <ul> <li><code>tcp</code></li> <li><code>udp</code></li> <li><code>icmpv4</code></li> <li><code>icmpv6</code></li> </ul>"},{"location":"configuration/route/ip-rule/#domain","title":"domain","text":"<p>Match full domain.</p>"},{"location":"configuration/route/ip-rule/#domain_suffix","title":"domain_suffix","text":"<p>Match domain suffix.</p>"},{"location":"configuration/route/ip-rule/#domain_keyword","title":"domain_keyword","text":"<p>Match domain using keyword.</p>"},{"location":"configuration/route/ip-rule/#domain_regex","title":"domain_regex","text":"<p>Match domain using regular expression.</p>"},{"location":"configuration/route/ip-rule/#geosite","title":"geosite","text":"<p>Match geosite.</p>"},{"location":"configuration/route/ip-rule/#source_geoip","title":"source_geoip","text":"<p>Match source geoip.</p>"},{"location":"configuration/route/ip-rule/#geoip","title":"geoip","text":"<p>Match geoip.</p>"},{"location":"configuration/route/ip-rule/#source_ip_cidr","title":"source_ip_cidr","text":"<p>Match source ip cidr.</p>"},{"location":"configuration/route/ip-rule/#ip_cidr","title":"ip_cidr","text":"<p>Match ip cidr.</p>"},{"location":"configuration/route/ip-rule/#source_port","title":"source_port","text":"<p>Match source port.</p>"},{"location":"configuration/route/ip-rule/#source_port_range","title":"source_port_range","text":"<p>Match source port range.</p>"},{"location":"configuration/route/ip-rule/#port","title":"port","text":"<p>Match port.</p>"},{"location":"configuration/route/ip-rule/#port_range","title":"port_range","text":"<p>Match port range.</p>"},{"location":"configuration/route/ip-rule/#invert","title":"invert","text":"<p>Invert match result.</p>"},{"location":"configuration/route/ip-rule/#action","title":"action","text":"<p>Required</p> Action Description return Stop IP routing and assemble the connection to the transport layer block Block the connection direct Directly forward the connection"},{"location":"configuration/route/ip-rule/#outbound","title":"outbound","text":"<p>Required if action is direct</p> <p>Tag of the target outbound.</p> <p>Only outbound which supports IP connection can be used, see Outbounds that support IP connection.</p>"},{"location":"configuration/route/ip-rule/#logical-fields","title":"Logical Fields","text":""},{"location":"configuration/route/ip-rule/#type","title":"type","text":"<p><code>logical</code></p>"},{"location":"configuration/route/ip-rule/#mode","title":"mode","text":"<p>Required</p> <p><code>and</code> or <code>or</code></p>"},{"location":"configuration/route/ip-rule/#rules","title":"rules","text":"<p>Required</p> <p>Included default rules.</p>"},{"location":"configuration/route/rule/","title":"Route Rule","text":""},{"location":"configuration/route/rule/#structure","title":"Structure","text":"<pre><code>{\n\"route\": {\n\"rules\": [\n{\n\"inbound\": [\n\"mixed-in\"\n],\n\"ip_version\": 6,\n\"network\": [\n\"tcp\"\n],\n\"auth_user\": [\n\"usera\",\n\"userb\"\n],\n\"protocol\": [\n\"tls\",\n\"http\",\n\"quic\"\n],\n\"domain\": [\n\"test.com\"\n],\n\"domain_suffix\": [\n\".cn\"\n],\n\"domain_keyword\": [\n\"test\"\n],\n\"domain_regex\": [\n\"^stun\\\\..+\"\n],\n\"geosite\": [\n\"cn\"\n],\n\"source_geoip\": [\n\"private\"\n],\n\"geoip\": [\n\"cn\"\n],\n\"source_ip_cidr\": [\n\"10.0.0.0/24\",\n\"192.168.0.1\"\n],\n\"ip_cidr\": [\n\"10.0.0.0/24\",\n\"192.168.0.1\"\n],\n\"source_port\": [\n12345\n],\n\"source_port_range\": [\n\"1000:2000\",\n\":3000\",\n\"4000:\"\n],\n\"port\": [\n80,\n443\n],\n\"port_range\": [\n\"1000:2000\",\n\":3000\",\n\"4000:\"\n],\n\"process_name\": [\n\"curl\"\n],\n\"process_path\": [\n\"/usr/bin/curl\"\n],\n\"package_name\": [\n\"com.termux\"\n],\n\"user\": [\n\"sekai\"\n],\n\"user_id\": [\n1000\n],\n\"clash_mode\": \"direct\",\n\"invert\": false,\n\"outbound\": \"direct\"\n},\n{\n\"type\": \"logical\",\n\"mode\": \"and\",\n\"rules\": [],\n\"invert\": false,\n\"outbound\": \"direct\"\n}\n]\n}\n}\n</code></pre> <p>You can ignore the JSON Array [] tag when the content is only one item</p>"},{"location":"configuration/route/rule/#default-fields","title":"Default Fields","text":"<p>The default rule uses the following matching logic: (<code>domain</code> || <code>domain_suffix</code> || <code>domain_keyword</code> || <code>domain_regex</code> || <code>geosite</code> || <code>geoip</code> || <code>ip_cidr</code>) &amp;&amp; (<code>port</code> || <code>port_range</code>) &amp;&amp; (<code>source_geoip</code> || <code>source_ip_cidr</code>) &amp;&amp; (<code>source_port</code> || <code>source_port_range</code>) &amp;&amp; <code>other fields</code></p>"},{"location":"configuration/route/rule/#inbound","title":"inbound","text":"<p>Tags of Inbound.</p>"},{"location":"configuration/route/rule/#ip_version","title":"ip_version","text":"<p>4 or 6.</p> <p>Not limited if empty.</p>"},{"location":"configuration/route/rule/#auth_user","title":"auth_user","text":"<p>Username, see each inbound for details.</p>"},{"location":"configuration/route/rule/#protocol","title":"protocol","text":"<p>Sniffed protocol, see Sniff for details.</p>"},{"location":"configuration/route/rule/#network","title":"network","text":"<p><code>tcp</code> or <code>udp</code>.</p>"},{"location":"configuration/route/rule/#domain","title":"domain","text":"<p>Match full domain.</p>"},{"location":"configuration/route/rule/#domain_suffix","title":"domain_suffix","text":"<p>Match domain suffix.</p>"},{"location":"configuration/route/rule/#domain_keyword","title":"domain_keyword","text":"<p>Match domain using keyword.</p>"},{"location":"configuration/route/rule/#domain_regex","title":"domain_regex","text":"<p>Match domain using regular expression.</p>"},{"location":"configuration/route/rule/#geosite","title":"geosite","text":"<p>Match geosite.</p>"},{"location":"configuration/route/rule/#source_geoip","title":"source_geoip","text":"<p>Match source geoip.</p>"},{"location":"configuration/route/rule/#geoip","title":"geoip","text":"<p>Match geoip.</p>"},{"location":"configuration/route/rule/#source_ip_cidr","title":"source_ip_cidr","text":"<p>Match source ip cidr.</p>"},{"location":"configuration/route/rule/#ip_cidr","title":"ip_cidr","text":"<p>Match ip cidr.</p>"},{"location":"configuration/route/rule/#source_port","title":"source_port","text":"<p>Match source port.</p>"},{"location":"configuration/route/rule/#source_port_range","title":"source_port_range","text":"<p>Match source port range.</p>"},{"location":"configuration/route/rule/#port","title":"port","text":"<p>Match port.</p>"},{"location":"configuration/route/rule/#port_range","title":"port_range","text":"<p>Match port range.</p>"},{"location":"configuration/route/rule/#process_name","title":"process_name","text":"<p>Only supported on Linux, Windows, and macOS.</p> <p>Match process name.</p>"},{"location":"configuration/route/rule/#process_path","title":"process_path","text":"<p>Only supported on Linux, Windows, and macOS.</p> <p>Match process path.</p>"},{"location":"configuration/route/rule/#package_name","title":"package_name","text":"<p>Match android package name.</p>"},{"location":"configuration/route/rule/#user","title":"user","text":"<p>Only supported on Linux.</p> <p>Match user name.</p>"},{"location":"configuration/route/rule/#user_id","title":"user_id","text":"<p>Only supported on Linux.</p> <p>Match user id.</p>"},{"location":"configuration/route/rule/#clash_mode","title":"clash_mode","text":"<p>Match Clash mode.</p>"},{"location":"configuration/route/rule/#invert","title":"invert","text":"<p>Invert match result.</p>"},{"location":"configuration/route/rule/#outbound","title":"outbound","text":"<p>Required</p> <p>Tag of the target outbound.</p>"},{"location":"configuration/route/rule/#logical-fields","title":"Logical Fields","text":""},{"location":"configuration/route/rule/#type","title":"type","text":"<p><code>logical</code></p>"},{"location":"configuration/route/rule/#mode","title":"mode","text":"<p>Required</p> <p><code>and</code> or <code>or</code></p>"},{"location":"configuration/route/rule/#rules","title":"rules","text":"<p>Required</p> <p>Included default rules.</p>"},{"location":"configuration/route/sniff/","title":"Protocol Sniff","text":"<p>If enabled in the inbound, the protocol and domain name (if present) of by the connection can be sniffed.</p>"},{"location":"configuration/route/sniff/#supported-protocols","title":"Supported Protocols","text":"Network Protocol Domain Name TCP HTTP Host TCP TLS Server Name UDP QUIC Server Name UDP STUN / TCP/UDP DNS /"},{"location":"configuration/shared/dial/","title":"Dial Fields","text":""},{"location":"configuration/shared/dial/#structure","title":"Structure","text":"<pre><code>{\n\"detour\": \"upstream-out\",\n\"bind_interface\": \"en0\",\n\"inet4_bind_address\": \"0.0.0.0\",\n\"inet6_bind_address\": \"::\",\n\"routing_mark\": 1234,\n\"reuse_addr\": false,\n\"connect_timeout\": \"5s\",\n\"tcp_fast_open\": false,\n\"udp_fragment\": false,\n\"domain_strategy\": \"prefer_ipv6\",\n\"fallback_delay\": \"300ms\"\n}\n</code></pre>"},{"location":"configuration/shared/dial/#fields","title":"Fields","text":"Field Available Context <code>bind_interface</code> /<code>*bind_address</code> /<code>routing_mark</code> /<code>reuse_addr</code> / <code>tcp_fast_open</code>/ <code>udp_fragment</code> /<code>connect_timeout</code> <code>detour</code> not set"},{"location":"configuration/shared/dial/#detour","title":"detour","text":"<p>The tag of the upstream outbound.</p>"},{"location":"configuration/shared/dial/#bind_interface","title":"bind_interface","text":"<p>The network interface to bind to.</p>"},{"location":"configuration/shared/dial/#inet4_bind_address","title":"inet4_bind_address","text":"<p>The IPv4 address to bind to.</p>"},{"location":"configuration/shared/dial/#inet6_bind_address","title":"inet6_bind_address","text":"<p>The IPv6 address to bind to.</p>"},{"location":"configuration/shared/dial/#routing_mark","title":"routing_mark","text":"<p>Only supported on Linux.</p> <p>Set netfilter routing mark.</p>"},{"location":"configuration/shared/dial/#reuse_addr","title":"reuse_addr","text":"<p>Reuse listener address.</p>"},{"location":"configuration/shared/dial/#tcp_fast_open","title":"tcp_fast_open","text":"<p>Enable TCP Fast Open.</p>"},{"location":"configuration/shared/dial/#udp_fragment","title":"udp_fragment","text":"<p>Enable UDP fragmentation.</p>"},{"location":"configuration/shared/dial/#connect_timeout","title":"connect_timeout","text":"<p>Connect timeout, in golang's Duration format.</p> <p>A duration string is a possibly signed sequence of decimal numbers, each with optional fraction and a unit suffix, such as \"300ms\", \"-1.5h\" or \"2h45m\". Valid time units are \"ns\", \"us\" (or \"\u00b5s\"), \"ms\", \"s\", \"m\", \"h\".</p>"},{"location":"configuration/shared/dial/#domain_strategy","title":"domain_strategy","text":"<p>One of <code>prefer_ipv4</code> <code>prefer_ipv6</code> <code>ipv4_only</code> <code>ipv6_only</code>.</p> <p>If set, the requested domain name will be resolved to IP before connect.</p> Outbound Effected domains Fallback Value <code>direct</code> Domain in request Take <code>inbound.domain_strategy</code> if not set others Domain in server address /"},{"location":"configuration/shared/dial/#fallback_delay","title":"fallback_delay","text":"<p>The length of time to wait before spawning a RFC 6555 Fast Fallback connection. That is, is the amount of time to wait for connection to succeed before assuming that IPv4/IPv6 is misconfigured and falling back to other type of addresses. If zero, a default delay of 300ms is used.</p> <p>Only take effect when <code>domain_strategy</code> is set.</p>"},{"location":"configuration/shared/listen/","title":"Listen Fields","text":""},{"location":"configuration/shared/listen/#structure","title":"Structure","text":"<pre><code>{\n\"listen\": \"::\",\n\"listen_port\": 5353,\n\"tcp_fast_open\": false,\n\"udp_fragment\": false,\n\"sniff\": false,\n\"sniff_override_destination\": false,\n\"sniff_timeout\": \"300ms\",\n\"domain_strategy\": \"prefer_ipv6\",\n\"udp_timeout\": 300,\n\"proxy_protocol\": false,\n\"proxy_protocol_accept_no_header\": false,\n\"detour\": \"another-in\"\n}\n</code></pre>"},{"location":"configuration/shared/listen/#fields","title":"Fields","text":"Field Available Context <code>listen</code> Needs to listen on TCP or UDP. <code>listen_port</code> Needs to listen on TCP or UDP. <code>tcp_fast_open</code> Needs to listen on TCP. <code>udp_timeout</code> Needs to assemble UDP connections, currently Tun and Shadowsocks. <code>proxy_protocol</code> Needs to listen on TCP. <code>proxy_protocol_accept_no_header</code> When <code>proxy_protocol</code> enabled"},{"location":"configuration/shared/listen/#listen","title":"listen","text":"<p>Required</p> <p>Listen address.</p>"},{"location":"configuration/shared/listen/#listen_port","title":"listen_port","text":"<p>Listen port.</p>"},{"location":"configuration/shared/listen/#tcp_fast_open","title":"tcp_fast_open","text":"<p>Enable TCP Fast Open.</p>"},{"location":"configuration/shared/listen/#udp_fragment","title":"udp_fragment","text":"<p>Enable UDP fragmentation.</p>"},{"location":"configuration/shared/listen/#sniff","title":"sniff","text":"<p>Enable sniffing.</p> <p>See Protocol Sniff for details.</p>"},{"location":"configuration/shared/listen/#sniff_override_destination","title":"sniff_override_destination","text":"<p>Override the connection destination address with the sniffed domain.</p> <p>If the domain name is invalid (like tor), this will not work.</p>"},{"location":"configuration/shared/listen/#sniff_timeout","title":"sniff_timeout","text":"<p>Timeout for sniffing.</p> <p>300ms is used by default.</p>"},{"location":"configuration/shared/listen/#domain_strategy","title":"domain_strategy","text":"<p>One of <code>prefer_ipv4</code> <code>prefer_ipv6</code> <code>ipv4_only</code> <code>ipv6_only</code>.</p> <p>If set, the requested domain name will be resolved to IP before routing.</p> <p>If <code>sniff_override_destination</code> is in effect, its value will be taken as a fallback.</p>"},{"location":"configuration/shared/listen/#udp_timeout","title":"udp_timeout","text":"<p>UDP NAT expiration time in seconds, default is 300 (5 minutes).</p>"},{"location":"configuration/shared/listen/#proxy_protocol","title":"proxy_protocol","text":"<p>Parse Proxy Protocol in the connection header.</p>"},{"location":"configuration/shared/listen/#proxy_protocol_accept_no_header","title":"proxy_protocol_accept_no_header","text":"<p>Accept connections without Proxy Protocol header.</p>"},{"location":"configuration/shared/listen/#detour","title":"detour","text":"<p>If set, connections will be forwarded to the specified inbound.</p> <p>Requires target inbound support, see Injectable.</p>"},{"location":"configuration/shared/multiplex/","title":"Multiplex","text":""},{"location":"configuration/shared/multiplex/#server-requirements","title":"Server Requirements","text":"<p><code>sing-box</code> :)</p>"},{"location":"configuration/shared/multiplex/#structure","title":"Structure","text":"<pre><code>{\n\"enabled\": true,\n\"protocol\": \"smux\",\n\"max_connections\": 4,\n\"min_streams\": 4,\n\"max_streams\": 0,\n\"padding\": false\n}\n</code></pre>"},{"location":"configuration/shared/multiplex/#fields","title":"Fields","text":""},{"location":"configuration/shared/multiplex/#enabled","title":"enabled","text":"<p>Enable multiplex.</p>"},{"location":"configuration/shared/multiplex/#protocol","title":"protocol","text":"<p>Multiplex protocol.</p> Protocol Description smux https://github.com/xtaci/smux yamux https://github.com/hashicorp/yamux h2mux https://golang.org/x/net/http2 <p>h2mux is used by default.</p>"},{"location":"configuration/shared/multiplex/#max_connections","title":"max_connections","text":"<p>Maximum connections.</p> <p>Conflict with <code>max_streams</code>.</p>"},{"location":"configuration/shared/multiplex/#min_streams","title":"min_streams","text":"<p>Minimum multiplexed streams in a connection before opening a new connection.</p> <p>Conflict with <code>max_streams</code>.</p>"},{"location":"configuration/shared/multiplex/#max_streams","title":"max_streams","text":"<p>Maximum multiplexed streams in a connection before opening a new connection.</p> <p>Conflict with <code>max_connections</code> and <code>min_streams</code>.</p>"},{"location":"configuration/shared/multiplex/#padding","title":"padding","text":"<p>Info</p> <p>Requires sing-box server version 1.3-beta9 or later.</p> <p>Enable padding.</p>"},{"location":"configuration/shared/tls/","title":"TLS","text":""},{"location":"configuration/shared/tls/#inbound","title":"Inbound","text":"<pre><code>{\n\"enabled\": true,\n\"server_name\": \"\",\n\"alpn\": [],\n\"min_version\": \"\",\n\"max_version\": \"\",\n\"cipher_suites\": [],\n\"certificate\": \"\",\n\"certificate_path\": \"\",\n\"key\": \"\",\n\"key_path\": \"\",\n\"acme\": {\n\"domain\": [],\n\"data_directory\": \"\",\n\"default_server_name\": \"\",\n\"email\": \"\",\n\"provider\": \"\",\n\"disable_http_challenge\": false,\n\"disable_tls_alpn_challenge\": false,\n\"alternative_http_port\": 0,\n\"alternative_tls_port\": 0,\n\"external_account\": {\n\"key_id\": \"\",\n\"mac_key\": \"\"\n}\n},\n\"reality\": {\n\"enabled\": false,\n\"handshake\": {\n\"server\": \"google.com\",\n\"server_port\": 443,\n... // Dial Fields\n},\n\"private_key\": \"UuMBgl7MXTPx9inmQp2UC7Jcnwc6XYbwDNebonM-FCc\",\n\"short_id\": [\n\"0123456789abcdef\"\n],\n\"max_time_difference\": \"1m\"\n}\n}\n</code></pre>"},{"location":"configuration/shared/tls/#outbound","title":"Outbound","text":"<pre><code>{\n\"enabled\": true,\n\"disable_sni\": false,\n\"server_name\": \"\",\n\"insecure\": false,\n\"alpn\": [],\n\"min_version\": \"\",\n\"max_version\": \"\",\n\"cipher_suites\": [],\n\"certificate\": \"\",\n\"certificate_path\": \"\",\n\"ech\": {\n\"enabled\": false,\n\"pq_signature_schemes_enabled\": false,\n\"dynamic_record_sizing_disabled\": false,\n\"config\": \"\"\n},\n\"utls\": {\n\"enabled\": false,\n\"fingerprint\": \"\"\n},\n\"reality\": {\n\"enabled\": false,\n\"public_key\": \"jNXHt1yRo0vDuchQlIP6Z0ZvjT3KtzVI-T4E7RoLJS0\",\n\"short_id\": \"0123456789abcdef\"\n}\n}\n</code></pre> <p>TLS version values:</p> <ul> <li><code>1.0</code></li> <li><code>1.1</code></li> <li><code>1.2</code></li> <li><code>1.3</code></li> </ul> <p>Cipher suite values:</p> <ul> <li><code>TLS_RSA_WITH_AES_128_CBC_SHA</code></li> <li><code>TLS_RSA_WITH_AES_256_CBC_SHA</code></li> <li><code>TLS_RSA_WITH_AES_128_GCM_SHA256</code></li> <li><code>TLS_RSA_WITH_AES_256_GCM_SHA384</code></li> <li><code>TLS_AES_128_GCM_SHA256</code></li> <li><code>TLS_AES_256_GCM_SHA384</code></li> <li><code>TLS_CHACHA20_POLY1305_SHA256</code></li> <li><code>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</code></li> <li><code>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</code></li> <li><code>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</code></li> <li><code>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</code></li> <li><code>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</code></li> <li><code>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</code></li> <li><code>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</code></li> <li><code>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</code></li> <li><code>TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256</code></li> <li><code>TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256</code></li> </ul> <p>You can ignore the JSON Array [] tag when the content is only one item</p>"},{"location":"configuration/shared/tls/#fields","title":"Fields","text":""},{"location":"configuration/shared/tls/#enabled","title":"enabled","text":"<p>Enable TLS.</p>"},{"location":"configuration/shared/tls/#disable_sni","title":"disable_sni","text":"<p>Client only</p> <p>Do not send server name in ClientHello.</p>"},{"location":"configuration/shared/tls/#server_name","title":"server_name","text":"<p>Used to verify the hostname on the returned certificates unless insecure is given.</p> <p>It is also included in the client's handshake to support virtual hosting unless it is an IP address.</p>"},{"location":"configuration/shared/tls/#insecure","title":"insecure","text":"<p>Client only</p> <p>Accepts any server certificate.</p>"},{"location":"configuration/shared/tls/#alpn","title":"alpn","text":"<p>List of supported application level protocols, in order of preference.</p> <p>If both peers support ALPN, the selected protocol will be one from this list, and the connection will fail if there is no mutually supported protocol.</p> <p>See Application-Layer Protocol Negotiation.</p>"},{"location":"configuration/shared/tls/#min_version","title":"min_version","text":"<p>The minimum TLS version that is acceptable.</p> <p>By default, TLS 1.2 is currently used as the minimum when acting as a client, and TLS 1.0 when acting as a server.</p>"},{"location":"configuration/shared/tls/#max_version","title":"max_version","text":"<p>The maximum TLS version that is acceptable.</p> <p>By default, the maximum version is currently TLS 1.3.</p>"},{"location":"configuration/shared/tls/#cipher_suites","title":"cipher_suites","text":"<p>The elliptic curves that will be used in an ECDHE handshake, in preference order.</p> <p>If empty, the default will be used. The client will use the first preference as the type for its key share in TLS 1.3. This may change in the future.</p>"},{"location":"configuration/shared/tls/#certificate","title":"certificate","text":"<p>The server certificate, in PEM format.</p>"},{"location":"configuration/shared/tls/#certificate_path","title":"certificate_path","text":"<p>The path to the server certificate, in PEM format.</p>"},{"location":"configuration/shared/tls/#key","title":"key","text":"<p>Server only</p> <p>The server private key, in PEM format.</p>"},{"location":"configuration/shared/tls/#key_path","title":"key_path","text":"<p>Server only</p> <p>The path to the server private key, in PEM format.</p>"},{"location":"configuration/shared/tls/#ech","title":"ech","text":"<p>Client only</p> <p>ECH is not included by default, see Installation.</p> <p>ECH (Encrypted Client Hello) is a TLS extension that allows a client to encrypt the first part of its ClientHello message.</p> <p>If you don't know how to fill in the other configuration, just set <code>enabled</code>.</p>"},{"location":"configuration/shared/tls/#utls","title":"utls","text":"<p>Client only</p> <p>uTLS is not included by default, see Installation.</p> <p>uTLS is poorly maintained and the effect may be unproven, use at your own risk.</p> <p>uTLS is a fork of \"crypto/tls\", which provides ClientHello fingerprinting resistance.</p> <p>Available fingerprint values:</p> <ul> <li>chrome</li> <li>firefox</li> <li>edge</li> <li>safari</li> <li>360</li> <li>qq</li> <li>ios</li> <li>android</li> <li>random</li> <li>randomized</li> </ul> <p>Chrome fingerprint will be used if empty.</p>"},{"location":"configuration/shared/tls/#acme-fields","title":"ACME Fields","text":"<p>ACME is not included by default, see Installation.</p>"},{"location":"configuration/shared/tls/#domain","title":"domain","text":"<p>List of domain.</p> <p>ACME will be disabled if empty.</p>"},{"location":"configuration/shared/tls/#data_directory","title":"data_directory","text":"<p>The directory to store ACME data.</p> <p><code>$XDG_DATA_HOME/certmagic|$HOME/.local/share/certmagic</code> will be used if empty.</p>"},{"location":"configuration/shared/tls/#default_server_name","title":"default_server_name","text":"<p>Server name to use when choosing a certificate if the ClientHello's ServerName field is empty.</p>"},{"location":"configuration/shared/tls/#email","title":"email","text":"<p>The email address to use when creating or selecting an existing ACME server account</p>"},{"location":"configuration/shared/tls/#provider","title":"provider","text":"<p>The ACME CA provider to use.</p> Value Provider <code>letsencrypt (default)</code> Let's Encrypt <code>zerossl</code> ZeroSSL <code>https://...</code> Custom"},{"location":"configuration/shared/tls/#disable_http_challenge","title":"disable_http_challenge","text":"<p>Disable all HTTP challenges.</p>"},{"location":"configuration/shared/tls/#disable_tls_alpn_challenge","title":"disable_tls_alpn_challenge","text":"<p>Disable all TLS-ALPN challenges</p>"},{"location":"configuration/shared/tls/#alternative_http_port","title":"alternative_http_port","text":"<p>The alternate port to use for the ACME HTTP challenge; if non-empty, this port will be used instead of 80 to spin up a listener for the HTTP challenge.</p>"},{"location":"configuration/shared/tls/#alternative_tls_port","title":"alternative_tls_port","text":"<p>The alternate port to use for the ACME TLS-ALPN challenge; the system must forward 443 to this port for challenge to succeed.</p>"},{"location":"configuration/shared/tls/#external_account","title":"external_account","text":"<p>EAB (External Account Binding) contains information necessary to bind or map an ACME account to some other account known by the CA.</p> <p>External account bindings are \"used to associate an ACME account with an existing account in a non-ACME system, such as a CA customer database.</p> <p>To enable ACME account binding, the CA operating the ACME server needs to provide the ACME client with a MAC key and a key identifier, using some mechanism outside of ACME. \u00a77.3.4</p>"},{"location":"configuration/shared/tls/#external_accountkey_id","title":"external_account.key_id","text":"<p>The key identifier.</p>"},{"location":"configuration/shared/tls/#external_accountmac_key","title":"external_account.mac_key","text":"<p>The MAC key.</p>"},{"location":"configuration/shared/tls/#reality-fields","title":"Reality Fields","text":"<p>reality server is not included by default, see Installation.</p> <p>uTLS, which is required by reality client is not included by default, see Installation.</p>"},{"location":"configuration/shared/tls/#handshake","title":"handshake","text":"<p>Server only</p> <p>Required</p> <p>Handshake server address and Dial options.</p>"},{"location":"configuration/shared/tls/#private_key","title":"private_key","text":"<p>Server only</p> <p>Required</p> <p>Private key, generated by <code>sing-box generate reality-keypair</code>.</p>"},{"location":"configuration/shared/tls/#public_key","title":"public_key","text":"<p>Client only</p> <p>Required</p> <p>Public key, generated by <code>sing-box generate reality-keypair</code>.</p>"},{"location":"configuration/shared/tls/#short_id","title":"short_id","text":"<p>Required</p> <p>A hexadecimal string with zero to eight digits.</p>"},{"location":"configuration/shared/tls/#max_time_difference","title":"max_time_difference","text":"<p>Server only</p> <p>The maximum time difference between the server and the client.</p> <p>Check disabled if empty.</p>"},{"location":"configuration/shared/tls/#reload","title":"Reload","text":"<p>For server configuration, certificate and key will be automatically reloaded if modified.</p>"},{"location":"configuration/shared/udp-over-tcp/","title":"UDP over TCP","text":"<p>It's a proprietary protocol created by SagerNet, not part of shadowsocks.</p> <p>The UDP over TCP protocol is used to transmit UDP packets in TCP.</p>"},{"location":"configuration/shared/udp-over-tcp/#structure","title":"Structure","text":"<pre><code>{\n\"enabled\": true,\n\"version\": 2\n}\n</code></pre> <p>The structure can be replaced with a boolean value when the version is not specified.</p>"},{"location":"configuration/shared/udp-over-tcp/#fields","title":"Fields","text":""},{"location":"configuration/shared/udp-over-tcp/#enabled","title":"enabled","text":"<p>Enable the UDP over TCP protocol.</p>"},{"location":"configuration/shared/udp-over-tcp/#version","title":"version","text":"<p>The protocol version, <code>1</code> or <code>2</code>.</p> <p>2 is used by default.</p>"},{"location":"configuration/shared/udp-over-tcp/#application-support","title":"Application support","text":"Project UoT v1 UoT v2 sing-box v0 (2022/08/11) v1.2-beta9 Xray-core v1.5.7 (2022/06/05) f57ec13 (Not released) Clash.Meta v1.12.0 (2022/07/02) 8cb67b6 (Not released) Shadowrocket v2.2.12 (2022/08/13) /"},{"location":"configuration/shared/udp-over-tcp/#protocol-details","title":"Protocol details","text":""},{"location":"configuration/shared/udp-over-tcp/#protocol-version-1","title":"Protocol version 1","text":"<p>The client requests the magic address to the upper layer proxy protocol to indicate the request: <code>sp.udp-over-tcp.arpa</code></p>"},{"location":"configuration/shared/udp-over-tcp/#stream-format","title":"Stream format","text":"ATYP address port length data u8 variable u16be u16be variable <p>ATYP / address / port: Uses the SOCKS address format.</p>"},{"location":"configuration/shared/udp-over-tcp/#protocol-version-2","title":"Protocol version 2","text":"<p>Protocol version 2 uses a new magic address: <code>sp.v2.udp-over-tcp.arpa</code></p>"},{"location":"configuration/shared/udp-over-tcp/#request-format","title":"Request format","text":"isConnect ATYP address port u8 u8 variable u16be <p>isConnect: Set to 1 to indicates that the stream uses the connect format, 0 to disable.</p> <p>ATYP / address / port: Request destination, uses the SOCKS address format.</p>"},{"location":"configuration/shared/udp-over-tcp/#connect-stream-format","title":"Connect stream format","text":"length data u16be variable"},{"location":"configuration/shared/udp-over-tcp/#non-connect-stream-format","title":"Non-connect stream format","text":"<p>As the same as the stream format in protocol version 1.</p>"},{"location":"configuration/shared/v2ray-transport/","title":"V2Ray Transport","text":"<p>V2Ray Transport is a set of private protocols invented by v2ray, and has contaminated the names of other protocols, such as <code>trojan-grpc</code> in clash.</p>"},{"location":"configuration/shared/v2ray-transport/#structure","title":"Structure","text":"<pre><code>{\n\"type\": \"\"\n}\n</code></pre> <p>Available transports:</p> <ul> <li>HTTP</li> <li>WebSocket</li> <li>QUIC</li> <li>gRPC</li> </ul> <p>Difference from v2ray-core</p> <ul> <li>No TCP transport, plain HTTP is merged into the HTTP transport.</li> <li>No mKCP transport.</li> <li>No DomainSocket transport.</li> </ul> <p>You can ignore the JSON Array [] tag when the content is only one item</p>"},{"location":"configuration/shared/v2ray-transport/#http","title":"HTTP","text":"<pre><code>{\n\"type\": \"http\",\n\"host\": [],\n\"path\": \"\",\n\"method\": \"\",\n\"headers\": {},\n\"idle_timeout\": \"15s\",\n\"ping_timeout\": \"15s\"\n}\n</code></pre> <p>Difference from v2ray-core</p> <p>TLS is not enforced. If TLS is not configured, plain HTTP 1.1 is used.</p>"},{"location":"configuration/shared/v2ray-transport/#host","title":"host","text":"<p>List of host domain.</p> <p>The client will choose randomly and the server will verify if not empty.</p>"},{"location":"configuration/shared/v2ray-transport/#path","title":"path","text":"<p>Path of HTTP request.</p> <p>The server will verify if not empty.</p>"},{"location":"configuration/shared/v2ray-transport/#method","title":"method","text":"<p>Method of HTTP request.</p> <p>The server will verify if not empty.</p>"},{"location":"configuration/shared/v2ray-transport/#headers","title":"headers","text":"<p>Extra headers of HTTP request.</p> <p>The server will write in response if not empty.</p>"},{"location":"configuration/shared/v2ray-transport/#idle_timeout","title":"idle_timeout","text":"<p>In HTTP2 server:</p> <p>Specifies the time until idle clients should be closed with a GOAWAY frame. PING frames are not considered as activity.</p> <p>In HTTP2 client:</p> <p>Specifies the period of time after which a health check will be performed using a ping frame if no frames have been received on the connection. Please note that a ping response is considered a received frame, so if there is no other traffic on the connection, the health check will be executed every interval. If the value is zero, no health check will be performed.</p> <p>Zero is used by default.</p>"},{"location":"configuration/shared/v2ray-transport/#ping_timeout","title":"ping_timeout","text":"<p>In HTTP2 client:</p> <p>Specifies the timeout duration after sending a PING frame, within which a response must be received. If a response to the PING frame is not received within the specified timeout duration, the connection will be closed. The default timeout duration is 15 seconds.</p>"},{"location":"configuration/shared/v2ray-transport/#websocket","title":"WebSocket","text":"<pre><code>{\n\"type\": \"ws\",\n\"path\": \"\",\n\"headers\": {},\n\"max_early_data\": 0,\n\"early_data_header_name\": \"\"\n}\n</code></pre>"},{"location":"configuration/shared/v2ray-transport/#path_1","title":"path","text":"<p>Path of HTTP request.</p> <p>The server will verify if not empty.</p>"},{"location":"configuration/shared/v2ray-transport/#headers_1","title":"headers","text":"<p>Extra headers of HTTP request.</p>"},{"location":"configuration/shared/v2ray-transport/#max_early_data","title":"max_early_data","text":"<p>Allowed payload size is in the request. Enabled if not zero.</p>"},{"location":"configuration/shared/v2ray-transport/#early_data_header_name","title":"early_data_header_name","text":"<p>Early data is sent in path instead of header by default.</p> <p>To be compatible with Xray-core, set this to <code>Sec-WebSocket-Protocol</code>.</p> <p>It needs to be consistent with the server.</p>"},{"location":"configuration/shared/v2ray-transport/#quic","title":"QUIC","text":"<pre><code>{\n\"type\": \"quic\"\n}\n</code></pre> <p>QUIC is not included by default, see Installation.</p> <p>Difference from v2ray-core</p> <p>No additional encryption support: It's basically duplicate encryption. And Xray-core is not compatible with v2ray-core in here.</p>"},{"location":"configuration/shared/v2ray-transport/#grpc","title":"gRPC","text":"<p>standard gRPC has good compatibility but poor performance and is not included by default, see Installation.</p> <pre><code>{\n\"type\": \"grpc\",\n\"service_name\": \"TunService\",\n\"idle_timeout\": \"15s\",\n\"ping_timeout\": \"15s\",\n\"permit_without_stream\": false\n}\n</code></pre>"},{"location":"configuration/shared/v2ray-transport/#service_name","title":"service_name","text":"<p>Service name of gRPC.</p>"},{"location":"configuration/shared/v2ray-transport/#idle_timeout_1","title":"idle_timeout","text":"<p>In standard gRPC server/client:</p> <p>If the transport doesn't see any activity after a duration of this time, it pings the client to check if the connection is still active.</p> <p>In default gRPC server/client:</p> <p>It has the same behavior as the corresponding setting in HTTP transport.</p>"},{"location":"configuration/shared/v2ray-transport/#ping_timeout_1","title":"ping_timeout","text":"<p>In standard gRPC server/client:</p> <p>The timeout that after performing a keepalive check, the client will wait for activity. If no activity is detected, the connection will be closed.</p> <p>In default gRPC server/client:</p> <p>It has the same behavior as the corresponding setting in HTTP transport.</p>"},{"location":"configuration/shared/v2ray-transport/#permit_without_stream","title":"permit_without_stream","text":"<p>In standard gRPC client:</p> <p>If enabled, the client transport sends keepalive pings even with no active connections. If disabled, when there are no active connections, <code>idle_timeout</code> and <code>ping_timeout</code> will be ignored and no keepalive pings will be sent.</p> <p>Disabled by default.</p>"},{"location":"contributing/","title":"Contributing to sing-box","text":"<p>An introduction to contributing to the sing-box project.</p> <p>The sing-box project welcomes, and depends, on contributions from developers and users in the open source community. Contributions can be made in a number of ways, a few examples are:</p> <ul> <li>Code patches via pull requests</li> <li>Documentation improvements</li> <li>Bug reports and patch reviews</li> </ul>"},{"location":"contributing/#reporting-an-issue","title":"Reporting an Issue?","text":"<p>Please follow the issue template to submit bugs. Always include FULL log content, especially if you don't understand the code that generates it.</p>"},{"location":"contributing/environment/","title":"Development environment","text":""},{"location":"contributing/environment/#for-the-documentation","title":"For the documentation","text":""},{"location":"contributing/environment/#setup","title":"Setup","text":"<p>You need to configure python3 and pip first.</p> <pre><code>pip install mkdocs-material mkdocs-static-i18n\n</code></pre>"},{"location":"contributing/environment/#run-the-site-locally","title":"Run the site locally","text":"<pre><code>mkdocs serve\n</code></pre> <p>or</p> <pre><code>python3 -m mkdocs serve\n</code></pre>"},{"location":"contributing/environment/#for-the-project","title":"For the project","text":"<p>By default you have the latest Go installed (currently 1.19), and added <code>GOPATH/bin</code> to the PATH environment variable.</p>"},{"location":"contributing/environment/#setup_1","title":"Setup","text":"<pre><code>make fmt_insalll\nmake lint_install\n</code></pre> <p>This installs the formatting and lint tools, which can be used via <code>make fmt</code> and <code>make lint</code>.</p> <p>For ProtoBuffer changes, you also need <code>make proto_install</code> and <code>make proto</code>.</p>"},{"location":"contributing/environment/#build-binary-to-the-project-directory","title":"Build binary to the project directory","text":"<pre><code>make\n</code></pre>"},{"location":"contributing/environment/#install-binary-to-gopathbin","title":"Install binary to GOPATH/bin","text":"<pre><code>make install\n</code></pre>"},{"location":"contributing/sub-projects/","title":"Sub projects","text":"<p>The sing-box uses the following projects which also need to be maintained:</p>"},{"location":"contributing/sub-projects/#sing","title":"sing","text":"<p>Link: GitHub repository</p> <p>As a base tool library, there are no dependencies other than <code>golang.org/x/sys</code>.</p>"},{"location":"contributing/sub-projects/#sing-dns","title":"sing-dns","text":"<p>Link: GitHub repository</p> <p>Handles DNS lookups and caching.</p>"},{"location":"contributing/sub-projects/#sing-tun","title":"sing-tun","text":"<p>Link: GitHub repository</p> <p>Handle Tun traffic forwarding, configure routing, monitor network and routing.</p> <p>This library needs to periodically update its dependency gVisor (according to tags), including checking for changes to the used parts of the code and updating its usage. If you are involved in maintenance, you also need to check that if it works or contains memory leaks.</p>"},{"location":"contributing/sub-projects/#sing-shadowsocks","title":"sing-shadowsocks","text":"<p>Link: GitHub repository</p> <p>Provides Shadowsocks client and server</p>"},{"location":"contributing/sub-projects/#sing-vmess","title":"sing-vmess","text":"<p>Link: GitHub repository</p> <p>Provides VMess client and server</p>"},{"location":"contributing/sub-projects/#netlink","title":"netlink","text":"<p>Link: GitHub repository</p> <p>Fork of <code>vishvananda/netlink</code>, with some rule fixes.</p> <p>The library needs to be updated with the upstream.</p>"},{"location":"contributing/sub-projects/#quic-go","title":"quic-go","text":"<p>Link: GitHub repository</p> <p>Fork of <code>lucas-clemente/quic-go</code>  and <code>HyNetwork/quic-go</code>, contains quic flow control and other fixes used by Hysteria.</p> <p>Since the author of Hysteria does not follow the upstream updates in time, and the provided fork needs to use replace, we need to do this.</p> <p>The library needs to be updated with the upstream.</p>"},{"location":"contributing/sub-projects/#smux","title":"smux","text":"<p>Link: GitHub repository</p> <p>Fork of <code>xtaci/smux</code></p> <p>Modify the code to support the writev it uses internally and unify the buffer pool, which prevents it from allocating 64k buffers for per connection and improves performance.</p> <p>Upstream doesn't seem to be updated anymore, maybe a replacement is needed.</p> <p>Note: while yamux is still actively maintained and better known, it seems to be less performant.</p>"},{"location":"examples/","title":"Examples","text":"<p>Configuration examples for sing-box.</p> <ul> <li>Linux Server Installation</li> <li>Tun</li> <li>DNS Hijack</li> <li>Shadowsocks</li> <li>ShadowTLS</li> <li>Clash API</li> <li>WireGuard Direct</li> <li>FakeIP</li> </ul>"},{"location":"examples/clash-api/","title":"Clash API","text":"<pre><code>{\n\"dns\": {\n\"rules\": [\n{\n\"domain\": [\n\"clash.razord.top\",\n\"yacd.haishan.me\"\n],\n\"server\": \"local\"\n},\n{\n\"clash_mode\": \"direct\",\n\"server\": \"local\"\n}\n]\n},\n\"outbounds\": [\n{\n\"type\": \"selector\",\n\"tag\": \"default\",\n\"outbounds\": [\n\"proxy-a\",\n\"proxy-b\"\n]\n}\n],\n\"route\": {\n\"rules\": [\n{\n\"clash_mode\": \"direct\",\n\"outbound\": \"direct\"\n},\n{\n\"domain\": [\n\"clash.razord.top\",\n\"yacd.haishan.me\"\n],\n\"outbound\": \"direct\"\n}\n],\n\"final\": \"default\"\n},\n\"experimental\": {\n\"clash_api\": {\n\"external_controller\": \"127.0.0.1:9090\",\n\"store_selected\": true\n}\n}\n}\n</code></pre>"},{"location":"examples/dns-hijack/","title":"DNS Hijack","text":""},{"location":"examples/dns-hijack/#sniff-mode","title":"Sniff Mode","text":"<pre><code>{\n\"inbounds\": [\n{\n\"type\": \"tun\",\n\"inet4_address\": \"172.19.0.1/30\",\n\"auto_route\": true,\n\"sniff\": true // required\n}\n],\n\"outbounds\": [\n{\n\"type\": \"direct\"\n},\n{\n\"type\": \"dns\",\n\"tag\": \"dns-out\"\n}\n],\n\"route\": {\n\"rules\": [\n{\n\"protocol\": \"dns\",\n\"outbound\": \"dns-out\"\n}\n],\n\"auto_detect_interface\": true\n}\n}\n</code></pre>"},{"location":"examples/dns-hijack/#port-mode","title":"Port Mode","text":"<pre><code>{\n\"inbounds\": [\n{\n\"type\": \"tun\",\n\"inet4_address\": \"172.19.0.1/30\",\n\"auto_route\": true,\n\"sniff\": true // not required\n}\n],\n\"outbounds\": [\n{\n\"type\": \"direct\"\n},\n{\n\"type\": \"dns\",\n\"tag\": \"dns-out\"\n}\n],\n\"route\": {\n\"rules\": [\n{\n\"port\": 53,\n\"outbound\": \"dns-out\"\n}\n],\n\"auto_detect_interface\": true\n}\n}\n</code></pre>"},{"location":"examples/fakeip/","title":"FakeIP","text":"<pre><code>{\n\"dns\": {\n\"servers\": [\n{\n\"tag\": \"google\",\n\"address\": \"tls://8.8.8.8\"\n},\n{\n\"tag\": \"local\",\n\"address\": \"223.5.5.5\",\n\"detour\": \"direct\"\n},\n{\n\"tag\": \"remote\",\n\"address\": \"fakeip\"\n},\n{\n\"tag\": \"block\",\n\"address\": \"rcode://success\"\n}\n],\n\"rules\": [\n{\n\"geosite\": \"category-ads-all\",\n\"server\": \"block\",\n\"disable_cache\": true\n},\n{\n\"outbound\": \"any\",\n\"server\": \"local\"\n},\n{\n\"geosite\": \"cn\",\n\"server\": \"local\"\n},\n{\n\"query_type\": [\n\"A\",\n\"AAAA\"\n],\n\"server\": \"remote\"\n}\n],\n\"fakeip\": {\n\"enabled\": true,\n\"inet4_range\": \"198.18.0.0/15\",\n\"inet6_range\": \"fc00::/18\"\n},\n\"independent_cache\": true,\n\"strategy\": \"ipv4_only\"\n},\n\"inbounds\": [\n{\n\"type\": \"tun\",\n\"inet4_address\": \"172.19.0.1/30\",\n\"auto_route\": true,\n\"sniff\": true,\n\"domain_strategy\": \"ipv4_only\" // remove this line if you want to resolve the domain remotely (if the server is not sing-box, UDP may not work due to wrong behavior).\n}\n],\n\"outbounds\": [\n{\n\"type\": \"shadowsocks\",\n\"tag\": \"proxy\",\n\"server\": \"mydomain.com\",\n\"server_port\": 8080,\n\"method\": \"2022-blake3-aes-128-gcm\",\n\"password\": \"8JCsPssfgS8tiRwiMlhARg==\"\n},\n{\n\"type\": \"direct\",\n\"tag\": \"direct\"\n},\n{\n\"type\": \"block\",\n\"tag\": \"block\"\n},\n{\n\"type\": \"dns\",\n\"tag\": \"dns-out\"\n}\n],\n\"route\": {\n\"rules\": [\n{\n\"protocol\": \"dns\",\n\"outbound\": \"dns-out\"\n},\n{\n\"geosite\": \"cn\",\n\"geoip\": [\n\"private\",\n\"cn\"\n],\n\"outbound\": \"direct\"\n},\n{\n\"geosite\": \"category-ads-all\",\n\"outbound\": \"block\"\n}\n],\n\"auto_detect_interface\": true\n}\n}\n</code></pre>"},{"location":"examples/linux-server-installation/","title":"Linux Server Installation","text":""},{"location":"examples/linux-server-installation/#requirements","title":"Requirements","text":"<ul> <li>Linux &amp; Systemd</li> <li>Git</li> <li>C compiler environment</li> </ul>"},{"location":"examples/linux-server-installation/#install","title":"Install","text":"<pre><code>git clone -b main https://github.com/SagerNet/sing-box\ncd sing-box\n./release/local/install_go.sh # skip if you have golang already installed\n./release/local/install.sh\n</code></pre> <p>Edit configuration file in <code>/usr/local/etc/sing-box/config.json</code></p> <pre><code>./release/local/enable.sh\n</code></pre>"},{"location":"examples/linux-server-installation/#update","title":"Update","text":"<pre><code>./release/local/update.sh\n</code></pre>"},{"location":"examples/linux-server-installation/#other-commands","title":"Other commands","text":"Operation Command Start <code>sudo systemctl start sing-box</code> Stop <code>sudo systemctl stop sing-box</code> Kill <code>sudo systemctl kill sing-box</code> Restart <code>sudo systemctl restart sing-box</code> Logs <code>sudo journalctl -u sing-box --output cat -e</code> New Logs <code>sudo journalctl -u sing-box --output cat -f</code> Uninstall <code>./release/local/uninstall.sh</code>"},{"location":"examples/shadowsocks/","title":"Shadowsocks","text":"<p>For censorship bypass usage in China, we recommend using UDP over TCP and disabling UDP on the server.</p>"},{"location":"examples/shadowsocks/#single-user","title":"Single User","text":""},{"location":"examples/shadowsocks/#server","title":"Server","text":"<pre><code>{\n\"inbounds\": [\n{\n\"type\": \"shadowsocks\",\n\"listen\": \"::\",\n\"listen_port\": 8080,\n\"network\": \"tcp\",\n\"method\": \"2022-blake3-aes-128-gcm\",\n\"password\": \"8JCsPssfgS8tiRwiMlhARg==\"\n}\n]\n}\n</code></pre>"},{"location":"examples/shadowsocks/#client","title":"Client","text":"<pre><code>{\n\"inbounds\": [\n{\n\"type\": \"mixed\",\n\"listen\": \"::\",\n\"listen_port\": 2080\n}\n],\n\"outbounds\": [\n{\n\"type\": \"shadowsocks\",\n\"server\": \"127.0.0.1\",\n\"server_port\": 8080,\n\"method\": \"2022-blake3-aes-128-gcm\",\n\"password\": \"8JCsPssfgS8tiRwiMlhARg==\",\n\"udp_over_tcp\": true\n}\n]\n}\n</code></pre>"},{"location":"examples/shadowsocks/#multiple-users","title":"Multiple Users","text":""},{"location":"examples/shadowsocks/#server_1","title":"Server","text":"<pre><code>{\n\"inbounds\": [\n{\n\"type\": \"shadowsocks\",\n\"listen\": \"::\",\n\"listen_port\": 8080,\n\"method\": \"2022-blake3-aes-128-gcm\",\n\"password\": \"8JCsPssfgS8tiRwiMlhARg==\",\n\"users\": [\n{\n\"name\": \"sekai\",\n\"password\": \"BXYxVUXJ9NgF7c7KPLQjkg==\"\n}\n]\n}\n]\n}\n</code></pre>"},{"location":"examples/shadowsocks/#client_1","title":"Client","text":"<pre><code>{\n\"inbounds\": [\n{\n\"type\": \"mixed\",\n\"listen\": \"::\",\n\"listen_port\": 2080\n}\n],\n\"outbounds\": [\n{\n\"type\": \"shadowsocks\",\n\"server\": \"127.0.0.1\",\n\"server_port\": 8080,\n\"method\": \"2022-blake3-aes-128-gcm\",\n\"password\": \"8JCsPssfgS8tiRwiMlhARg==:BXYxVUXJ9NgF7c7KPLQjkg==\"\n}\n]\n}\n</code></pre>"},{"location":"examples/shadowsocks/#relay","title":"Relay","text":""},{"location":"examples/shadowsocks/#server_2","title":"Server","text":"<pre><code>{\n\"inbounds\": [\n{\n\"type\": \"shadowsocks\",\n\"listen\": \"::\",\n\"listen_port\": 8080,\n\"method\": \"2022-blake3-aes-128-gcm\",\n\"password\": \"8JCsPssfgS8tiRwiMlhARg==\"\n}\n]\n}\n</code></pre>"},{"location":"examples/shadowsocks/#relay_1","title":"Relay","text":"<pre><code>{\n\"inbounds\": [\n{\n\"type\": \"shadowsocks\",\n\"listen\": \"::\",\n\"listen_port\": 8081,\n\"method\": \"2022-blake3-aes-128-gcm\",\n\"password\": \"BXYxVUXJ9NgF7c7KPLQjkg==\",\n\"destinations\": [\n{\n\"name\": \"my_server\",\n\"password\": \"8JCsPssfgS8tiRwiMlhARg==\",\n\"server\": \"127.0.0.1\",\n\"server_port\": 8080\n}\n]\n}\n]\n}\n</code></pre>"},{"location":"examples/shadowsocks/#client_2","title":"Client","text":"<pre><code>{\n\"inbounds\": [\n{\n\"type\": \"mixed\",\n\"listen\": \"::\",\n\"listen_port\": 2080\n}\n],\n\"outbounds\": [\n{\n\"type\": \"shadowsocks\",\n\"server\": \"127.0.0.1\",\n\"server_port\": 8081,\n\"method\": \"2022-blake3-aes-128-gcm\",\n\"password\": \"8JCsPssfgS8tiRwiMlhARg==:BXYxVUXJ9NgF7c7KPLQjkg==\"\n}\n]\n}\n</code></pre>"},{"location":"examples/shadowtls/","title":"ShadowTLS","text":""},{"location":"examples/shadowtls/#server","title":"Server","text":"<pre><code>{\n\"inbounds\": [\n{\n\"type\": \"shadowtls\",\n\"listen\": \"::\",\n\"listen_port\": 4443,\n\"version\": 3,\n\"users\": [\n{\n\"name\": \"sekai\",\n\"password\": \"8JCsPssfgS8tiRwiMlhARg==\"\n}\n],\n\"handshake\": {\n\"server\": \"google.com\",\n\"server_port\": 443\n},\n\"detour\": \"shadowsocks-in\"\n},\n{\n\"type\": \"shadowsocks\",\n\"tag\": \"shadowsocks-in\",\n\"listen\": \"127.0.0.1\",\n\"network\": \"tcp\",\n\"method\": \"2022-blake3-aes-128-gcm\",\n\"password\": \"8JCsPssfgS8tiRwiMlhARg==\"\n}\n]\n}\n</code></pre>"},{"location":"examples/shadowtls/#client","title":"Client","text":"<pre><code>{\n\"outbounds\": [\n{\n\"type\": \"shadowsocks\",\n\"method\": \"2022-blake3-aes-128-gcm\",\n\"password\": \"8JCsPssfgS8tiRwiMlhARg==\",\n\"detour\": \"shadowtls-out\",\n\"multiplex\": {\n\"enabled\": true,\n\"max_connections\": 4,\n\"min_streams\": 4\n}\n// or \"udp_over_tcp\": true\n},\n{\n\"type\": \"shadowtls\",\n\"tag\": \"shadowtls-out\",\n\"server\": \"127.0.0.1\",\n\"server_port\": 4443,\n\"version\": 3,\n\"password\": \"8JCsPssfgS8tiRwiMlhARg==\",\n\"tls\": {\n\"enabled\": true,\n\"server_name\": \"google.com\",\n\"utls\": {\n\"enabled\": true,\n\"fingerprint\": \"chrome\"\n}\n}\n}\n]\n}\n</code></pre>"},{"location":"examples/tun/","title":"Tun","text":"<pre><code>{\n\"dns\": {\n\"servers\": [\n{\n\"tag\": \"google\",\n\"address\": \"tls://8.8.8.8\"\n},\n{\n\"tag\": \"local\",\n\"address\": \"223.5.5.5\",\n\"detour\": \"direct\"\n},\n{\n\"tag\": \"block\",\n\"address\": \"rcode://success\"\n}\n],\n\"rules\": [\n{\n\"geosite\": \"category-ads-all\",\n\"server\": \"block\",\n\"disable_cache\": true\n},\n{\n\"outbound\": \"any\",\n\"server\": \"local\"\n},\n{\n\"geosite\": \"cn\",\n\"server\": \"local\"\n}\n],\n\"strategy\": \"ipv4_only\"\n},\n\"inbounds\": [\n{\n\"type\": \"tun\",\n\"inet4_address\": \"172.19.0.1/30\",\n\"auto_route\": true,\n\"strict_route\": false,\n\"sniff\": true\n}\n],\n\"outbounds\": [\n{\n\"type\": \"shadowsocks\",\n\"tag\": \"proxy\",\n\"server\": \"mydomain.com\",\n\"server_port\": 8080,\n\"method\": \"2022-blake3-aes-128-gcm\",\n\"password\": \"8JCsPssfgS8tiRwiMlhARg==\"\n},\n{\n\"type\": \"direct\",\n\"tag\": \"direct\"\n},\n{\n\"type\": \"block\",\n\"tag\": \"block\"\n},\n{\n\"type\": \"dns\",\n\"tag\": \"dns-out\"\n}\n],\n\"route\": {\n\"rules\": [\n{\n\"protocol\": \"dns\",\n\"outbound\": \"dns-out\"\n},\n{\n\"geosite\": \"cn\",\n\"geoip\": [\n\"private\",\n\"cn\"\n],\n\"outbound\": \"direct\"\n},\n{\n\"geosite\": \"category-ads-all\",\n\"outbound\": \"block\"\n}\n],\n\"auto_detect_interface\": true\n}\n}\n</code></pre>"},{"location":"examples/wireguard-direct/","title":"WireGuard Direct","text":"<pre><code>{\n\"dns\": {\n\"servers\": [\n{\n\"tag\": \"google\",\n\"address\": \"tls://8.8.8.8\"\n},\n{\n\"tag\": \"local\",\n\"address\": \"223.5.5.5\",\n\"detour\": \"direct\"\n}\n],\n\"rules\": [\n{\n\"geoip\": \"cn\",\n\"server\": \"direct\"\n}\n],\n\"reverse_mapping\": true\n},\n\"inbounds\": [\n{\n\"type\": \"tun\",\n\"tag\": \"tun\",\n\"inet4_address\": \"172.19.0.1/30\",\n\"auto_route\": true,\n\"sniff\": true,\n\"stack\": \"system\"\n}\n],\n\"outbounds\": [\n{\n\"type\": \"wireguard\",\n\"tag\": \"wg\",\n\"server\": \"127.0.0.1\",\n\"server_port\": 2345,\n\"local_address\": [\n\"172.19.0.1/128\"\n],\n\"private_key\": \"KLTnpPY03pig/WC3zR8U7VWmpANHPFh2/4pwICGJ5Fk=\",\n\"peer_public_key\": \"uvNabcamf6Rs0vzmcw99jsjTJbxo6eWGOykSY66zsUk=\"\n},\n{\n\"type\": \"dns\",\n\"tag\": \"dns\"\n},\n{\n\"type\": \"direct\",\n\"tag\": \"direct\"\n},\n{\n\"type\": \"block\",\n\"tag\": \"block\"\n}\n],\n\"route\": {\n\"ip_rules\": [\n{\n\"port\": 53,\n\"action\": \"return\"\n},\n{\n\"geoip\": \"cn\",\n\"geosite\": \"cn\",\n\"action\": \"return\"\n},\n{\n\"action\": \"direct\",\n\"outbound\": \"wg\"\n}\n],\n\"rules\": [\n{\n\"protocol\": \"dns\",\n\"outbound\": \"dns\"\n},\n{\n\"geoip\": \"cn\",\n\"geosite\": \"cn\",\n\"outbound\": \"direct\"\n}\n],\n\"auto_detect_interface\": true\n}\n}\n</code></pre>"},{"location":"faq/","title":"Frequently Asked Questions (FAQ)","text":""},{"location":"faq/#design","title":"Design","text":""},{"location":"faq/#why-does-sing-box-not-have-feature-x","title":"Why does sing-box not have feature X?","text":"<p>Every program contains novel features and omits someone's favorite feature. sing-box is designed with an eye to the needs of performance, lightweight, usability, modularity, and code quality. Your favorite feature may be missing because it doesn't fit, because it compromises performance or design clarity, or because it's a bad idea.</p> <p>If it bothers you that sing-box is missing feature X, please forgive us and investigate the features that sing-box does have. You might find that they compensate in interesting ways for the lack of X.</p>"},{"location":"faq/#naive-outbound","title":"Naive outbound","text":"<p>Na\u00efveProxy's main function is chromium's network stack, and it makes no sense to implement only its transport protocol.</p>"},{"location":"faq/#protocol-combinations","title":"Protocol combinations","text":"<p>The \"underlying transport\" in v2ray-core is actually a combination of a number of proprietary protocols and uses the names of their upstream protocols, resulting in a great deal of Linguistic corruption.</p> <p>For example, Trojan with v2ray's proprietary gRPC protocol, called Trojan gRPC by the v2ray community, is not actually a protocol and has no role outside of abusing CDNs.</p>"},{"location":"faq/#tun","title":"Tun","text":""},{"location":"faq/#what-is-tun","title":"What is tun?","text":"<p>tun is a virtual network device in unix systems, and in windows there is wintun developed by WireGuard as an alternative. The tun module of sing-box includes traffic processing, automatic routing, and network device listening, and is mainly used as a transparent proxy.</p>"},{"location":"faq/#how-is-it-different-from-system-proxy","title":"How is it different from system proxy?","text":"<p>System proxy usually only supports TCP and is not accepted by all applications, but tun can handle all traffic.</p>"},{"location":"faq/#how-is-it-different-from-traditional-transparent-proxy","title":"How is it different from traditional transparent proxy?","text":"<p>They are usually only supported under Linux and require manipulation of firewalls like iptables, while tun only modifies the routing table.</p> <p>The tproxy UDP is considered to have poor performance due to the need to create a new connection every write back in v2ray and clash, but it is optimized in sing-box so you can still use it if needed.</p>"},{"location":"faq/#how-does-it-handle-dns","title":"How does it handle DNS?","text":"<p>In traditional transparent proxies, it is usually necessary to manually hijack port 53 to the DNS proxy server, while tun is more flexible.</p> <p>sing-box's <code>auto_route</code> will hijack all DNS requests except on macOS and Android.</p> <p>You need to manually configure how to handle tun hijacked DNS traffic, see Hijack DNS.</p>"},{"location":"faq/#why-i-cant-use-it-with-other-local-proxies-eg-via-socks","title":"Why I can't use it with other local proxies (e.g. via socks)?","text":"<p>Tun will hijack all traffic, including other proxy applications. In order to make tun work with other applications, you need to create an inbound to proxy traffic from other applications or make them bypass the route.</p>"},{"location":"faq/fakeip/","title":"FakeIP","text":"<p>FakeIP refers to a type of behavior in a program that simultaneously hijacks both DNS and connection requests. It responds to DNS requests with virtual results and restores mapping when accepting connections.</p>"},{"location":"faq/fakeip/#advantage","title":"Advantage","text":"<p>*</p>"},{"location":"faq/fakeip/#limitation","title":"Limitation","text":"<ul> <li>Its mechanism breaks applications that depend on returning correct remote addresses.</li> <li>Only A and AAAA (IP) requests are supported, which may break applications that rely on other requests.</li> </ul>"},{"location":"faq/fakeip/#recommendation","title":"Recommendation","text":"<ul> <li>Enable <code>dns.independent_cache</code> unless you always resolve FakeIP domains remotely.</li> <li>If using tun, make sure FakeIP ranges is included in the tun's routes.</li> <li>Enable <code>experimental.clash_api.store_fakeip</code> to persist FakeIP records, or use <code>dns.rules.rewrite_ttl</code> to avoid losing records after program restart in DNS cached environments.</li> </ul>"},{"location":"faq/known-issues/","title":"Known Issues","text":""},{"location":"faq/known-issues/#dns","title":"DNS","text":""},{"location":"faq/known-issues/#on-macos","title":"on macOS","text":"<p><code>auto-route</code> cannot automatically hijack DNS requests sent to the LAN, so it's need to manually set DNS to servers on the public internet.</p>"},{"location":"faq/known-issues/#on-android","title":"on Android","text":"<p><code>auto-route</code> cannot automatically hijack DNS requests when Android's <code>Private DNS</code> enabled or <code>strict_route</code> disabled.</p>"},{"location":"faq/known-issues/#system-proxy","title":"System proxy","text":""},{"location":"faq/known-issues/#on-linux","title":"on Linux","text":"<p>Usually only browsers and GNOME applications accept GNOME proxy settings.</p>"},{"location":"faq/known-issues/#on-android_1","title":"on Android","text":"<p>With the system proxy enabled, some applications will error out (usually from China).</p>"},{"location":"installation/from-source/","title":"Install from source","text":"<p>sing-box requires Golang 1.18.5 or a higher version.</p> <pre><code>go install -v github.com/sagernet/sing-box/cmd/sing-box@latest\n</code></pre> <p>Install with options:</p> <pre><code>go install -v -tags with_clash_api github.com/sagernet/sing-box/cmd/sing-box@latest\n</code></pre> Build Tag Description <code>with_quic</code> Build with QUIC support, see QUIC and HTTP3 DNS transports, Naive inbound, Hysteria Inbound, Hysteria Outbound and V2Ray Transport#QUIC. <code>with_grpc</code> Build with standard gRPC support, see V2Ray Transport#gRPC. <code>with_dhcp</code> Build with DHCP support, see DHCP DNS transport. <code>with_wireguard</code> Build with WireGuard support, see WireGuard outbound. <code>with_shadowsocksr</code> Build with ShadowsocksR support, see ShadowsocksR outbound. <code>with_ech</code> Build with TLS ECH extension support for TLS outbound, see TLS. <code>with_utls</code> Build with uTLS support for TLS outbound, see TLS. <code>with_reality_server</code> Build with reality TLS server support,  see TLS. <code>with_acme</code> Build with ACME TLS certificate issuer support, see TLS. <code>with_clash_api</code> Build with Clash API support, see Experimental. <code>with_v2ray_api</code> Build with V2Ray API support, see Experimental. <code>with_gvisor</code> Build with gVisor support, see Tun inbound and WireGuard outbound. <code>with_embedded_tor</code> (CGO required) Build with embedded Tor support, see Tor outbound. <code>with_lwip</code> (CGO required) Build with LWIP Tun stack support, see Tun inbound. <p>The binary is built under $GOPATH/bin</p> <pre><code>sing-box version\n</code></pre> <p>It is also recommended to use systemd to manage sing-box service, see Linux server installation example.</p>"},{"location":"installation/clients/sfa/","title":"SFA","text":"<p>Experimental Android client for sing-box.</p>"},{"location":"installation/clients/sfa/#requirements","title":"Requirements","text":"<ul> <li>Android 5.0+</li> </ul>"},{"location":"installation/clients/sfa/#download","title":"Download","text":"<ul> <li>AppCenter</li> </ul>"},{"location":"installation/clients/sfa/#note","title":"Note","text":"<ul> <li>User Agent in remote profile request is <code>SFA/$version ($version_code; sing-box $sing_box_version)</code></li> <li>The working directory is located at <code>/sdcard/Android/data/io.nekohasekai.sfa/files</code> (External files directory)</li> <li>Crash logs is located in <code>$working_directory/stderr.log</code></li> </ul>"},{"location":"installation/clients/sfi/","title":"SFI","text":"<p>Experimental iOS client for sing-box.</p>"},{"location":"installation/clients/sfi/#requirements","title":"Requirements","text":"<ul> <li>iOS 15.0+</li> <li>macOS 12.0+ with Apple Silicon</li> </ul>"},{"location":"installation/clients/sfi/#download","title":"Download","text":"<ul> <li>TestFlight</li> </ul>"},{"location":"installation/clients/sfi/#note","title":"Note","text":"<ul> <li>User Agent in remote profile request is <code>SFI/$version ($version_code; sing-box $sing_box_version)</code></li> <li>Crash logs is located in <code>Settings</code> -&gt; <code>View Service Log</code></li> </ul>"},{"location":"installation/clients/sfi/#privacy-policy","title":"Privacy policy","text":"<ul> <li>SFI did not collect or share personal data.</li> <li>The data generated by the software is always on your device.</li> </ul>"}]}